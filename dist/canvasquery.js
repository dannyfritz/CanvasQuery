(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.canvasquery = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = fastApply;

function fastApply(fn, context, args) {
    
    switch (args ? args.length : 0) {
        case 0:
            return context ? fn.call(context) : fn();
        case 1:
            return context ? fn.call(context, args[0]) : fn(args[0]);
        case 2:
            return context ? fn.call(context, args[0], args[1]) : fn(args[0], args[1]);
        case 3:
            return context ? fn.call(context, args[0], args[1], args[2]) : fn(args[0], args[1], args[2]);
        case 4:
            return context ? fn.call(context, args[0], args[1], args[2], args[3]) : fn(args[0], args[1], args[2], args[3]);
        case 5:
            return context ? fn.call(context, args[0], args[1], args[2], args[3], args[4]) : fn(args[0], args[1], args[2], args[3], args[4]);
        default:
            return fn.apply(context, args);
    }
    
}
},{}],2:[function(require,module,exports){
var fastApply=require("fast-apply"),Canvas=window.HTMLCanvasElement,Image=window.HTMLImageElement,COCOONJS=navigator.isCocoonJS,cq=function(t){if(0===arguments.length){var e=cq.createCanvas(window.innerWidth,window.innerHeight);window.addEventListener("resize",function(){})}else if("string"==typeof t)var e=document.querySelector(t);else if("number"==typeof t)var e=cq.createCanvas(arguments[0],arguments[1]);else if(t instanceof Image)var e=cq.createCanvas(t);else{if(t instanceof cq.Layer)return t;var e=t}return new cq.Layer(e)};cq.lineSpacing=1,cq.defaultFont="Arial",cq.cocoon=function(t){if(0===arguments.length){var e=cq.createCocoonCanvas(window.innerWidth,window.innerHeight);window.addEventListener("resize",function(){})}else if("string"==typeof t)var e=document.querySelector(t);else if("number"==typeof t)var e=cq.createCocoonCanvas(arguments[0],arguments[1]);else if(t instanceof Image)var e=cq.createCocoonCanvas(t);else{if(t instanceof cq.Layer)return t;var e=t}return new cq.Layer(e)},cq.extend=function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[0][e]=arguments[t][e];return arguments[0]},cq.augment=function(){for(var t=1;t<arguments.length;t++)_.extend(arguments[0],arguments[t]),arguments[t](arguments[0])},cq.distance=function(t,e,i,a){if(arguments.length>2){var n=t-i,s=e-a;return Math.sqrt(n*n+s*s)}return Math.abs(t-e)},cq.extend(cq,{smoothing:!0,blend:function(t,e,i,a){"undefined"==typeof a&&(a=1);var t=cq(t),n=t.clone(),e=cq(e);return t.save(),t.globalAlpha(a),t.globalCompositeOperation(i),t.drawImage(e.canvas,0,0),t.restore(),n.save(),n.globalCompositeOperation("source-in"),n.drawImage(t.canvas,0,0),n.restore(),n},matchColor:function(t,e){for(var i=[],a=0;a<e.length;a++)i.push(cq.color(e[a]));for(var n=cq.color(t),s=[],r=0;r<i.length;r++){var h=i[r],o=Math.abs(n[0]-h[0]),c=Math.abs(n[1]-h[1]),g=Math.abs(n[2]-h[2]);s.push(o+c+g)}for(var l=0,r=0;r<e.length;r++)s[r]<s[l]&&(l=r);return e[l]},temp:function(t,e){return this.tempLayer||(this.tempLayer=cq(1,1)),t instanceof Image?(this.tempLayer.width=t.width,this.tempLayer.height=t.height,this.tempLayer.context.drawImage(t,0,0)):t instanceof Canvas?(this.tempLayer.width=t.width,this.tempLayer.height=t.height,this.tempLayer.context.drawImage(t,0,0)):t instanceof CanvasQuery.Layer?(this.tempLayer.width=t.width,this.tempLayer.height=t.height,this.tempLayer.context.drawImage(t.canvas,0,0)):(this.tempLayer.width=t,this.tempLayer.height=e),this.tempLayer},wrapValue:function(t,e,i){return e>t?i+t%i:t>=i?t%i:t},limitValue:function(t,e,i){return e>t?e:t>i?i:t},mix:function(t,e,i){return t+(e-t)*i},hexToRgb:function(t){return 7===t.length?["0x"+t[1]+t[2]|0,"0x"+t[3]+t[4]|0,"0x"+t[5]+t[6]|0]:["0x"+t[1]+t[1]|0,"0x"+t[2]+t[2]|0,"0x"+t[3]+t[3]|0]},rgbToHex:function(t,e,i){return"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1,7)},rgbToHsl:function(t,e,i){t instanceof Array&&(i=t[2],e=t[1],t=t[0]),t/=255,e/=255,i/=255;var a,n,s=Math.max(t,e,i),r=Math.min(t,e,i),h=(s+r)/2;if(s==r)a=n=0;else{var o=s-r;switch(n=h>.5?o/(2-s-r):o/(s+r),s){case t:a=(e-i)/o+(i>e?6:0);break;case e:a=(i-t)/o+2;break;case i:a=(t-e)/o+4}a/=6}return[a,n,h]},hue2rgb:function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t},hslToRgb:function(t,e,i){var a,n,s;if(0==e)a=n=s=i;else{var r=.5>i?i*(1+e):i+e-i*e,h=2*i-r;a=this.hue2rgb(h,r,t+1/3),n=this.hue2rgb(h,r,t),s=this.hue2rgb(h,r,t-1/3)}return[255*a|0,255*n|0,255*s|0]},rgbToHsv:function(t,e,i){t instanceof Array&&(i=t[2],e=t[1],t=t[0]),t/=255,e/=255,i/=255;var a,n,s=Math.max(t,e,i),r=Math.min(t,e,i),h=s,o=s-r;if(n=0==s?0:o/s,s==r)a=0;else{switch(s){case t:a=(e-i)/o+(i>e?6:0);break;case e:a=(i-t)/o+2;break;case i:a=(t-e)/o+4}a/=6}return[a,n,h]},hsvToRgb:function(t,e,i){var a,n,s,r=Math.floor(6*t),h=6*t-r,o=i*(1-e),c=i*(1-h*e),g=i*(1-(1-h)*e);switch(r%6){case 0:a=i,n=g,s=o;break;case 1:a=c,n=i,s=o;break;case 2:a=o,n=i,s=g;break;case 3:a=o,n=c,s=i;break;case 4:a=g,n=o,s=i;break;case 5:a=i,n=o,s=c}return[255*a,255*n,255*s]},color:function(){var t=new cq.Color;return t.parse(arguments[0],arguments[1]),t},poolArray:[],pool:function(){if(!this.poolArray.length)for(var t=0;100>t;t++)this.poolArray.push(this.createCanvas(1,1));return this.poolArray.pop()},createCanvas:function(t,e){var i=document.createElement("canvas");if(arguments[0]instanceof Image||arguments[0]instanceof Canvas){var a=arguments[0];i.width=a.width,i.height=a.height,i.getContext("2d").drawImage(a,0,0)}else i.width=t,i.height=e;return i},createCocoonCanvas:function(t,e){var i=document.createElement("screencanvas");if(arguments[0]instanceof Image){var a=arguments[0];i.width=a.width,i.height=a.height,i.getContext("2d").drawImage(a,0,0)}else i.width=t,i.height=e;return i},createImageData:function(t,e){return cq.createCanvas(t,e).getContext("2d").createImageData(t,e)}}),cq.Layer=function(t){this.context=t.getContext("2d"),this.canvas=t,this.alignX=0,this.alignY=0,this.aligned=!1,this.update()},cq.Layer.prototype={update:function(){this.context.webkitImageSmoothingEnabled=cq.smoothing,this.context.mozImageSmoothingEnabled=cq.smoothing,this.context.msImageSmoothingEnabled=cq.smoothing,this.context.imageSmoothingEnabled=cq.smoothing,COCOONJS&&Cocoon.Utils.setAntialias(cq.smoothing)},appendTo:function(t){if("object"==typeof t)var e=t;else var e=document.querySelector(t);return e.appendChild(this.canvas),this},a:function(t){return arguments.length?(this.previousAlpha=this.globalAlpha(),this.globalAlpha(t)):this.globalAlpha()},ra:function(){return this.a(this.previousAlpha)},realign:function(){return this.alignX=this.prevAlignX,this.alignY=this.prevAlignY,this},align:function(t,e){return"undefined"==typeof e&&(e=t),this.alignX=t,this.alignY=e,this},stars:function(t,e,i,a,n,s,r){return"undefined"==typeof i&&(i=.5),"undefined"==typeof a&&(a=.5),"undefined"==typeof n&&(n=0),"undefined"==typeof s&&(s=1),"undefined"==typeof r&&(r=s),this.save(),this.translate(t,e),this.align(i,a),this.rotate(n),this.scale(s,r),this},tars:function(t,e,i,a,n,s,r){return"undefined"==typeof i&&(i=.5),"undefined"==typeof a&&(a=.5),"undefined"==typeof n&&(n=0),"undefined"==typeof s&&(s=1),"undefined"==typeof r&&(r=s),this.translate(t,e),this.align(i,a),this.rotate(n),this.scale(s,r),this},drawImage:function(){return(this.alignX||this.alignY)&&(3===arguments.length?(arguments[1]-=arguments[0].width*this.alignX|0,arguments[2]-=arguments[0].height*this.alignY|0):9===arguments.length&&(arguments[5]-=arguments[7]*this.alignX|0,arguments[6]-=arguments[8]*this.alignY|0)),fastApply(this.context.drawImage,this.context,arguments),this},save:function(){return this.prevAlignX=this.alignX,this.prevAlignY=this.alignY,this.context.save(),this},restore:function(){return this.realign(),this.context.restore(),this},drawTile:function(t,e,i,a,n,s,r,h,o){},drawAtlasFrame:function(t,e,i,a){var e=t.frames[e];return this.drawRegion(t.image,e.region,i-e.width*this.alignX+e.offset[0]+e.region[2]*this.alignX,a-e.height*this.alignY+e.offset[1]+e.region[3]*this.alignY),this},drawRegion:function(t,e,i,a,n){return n=n||1,this.drawImage(t,e[0],e[1],e[2],e[3],0|i,0|a,e[2]*n|0,e[3]*n|0)},cache:function(){return this.clone().canvas},blendOn:function(t,e,i){return cq.blend(t,this,e,i),this},posterize:function(t,e){t=t||32,e=e||4;for(var i=this.getImageData(0,0,this.width,this.height),a=i.data,n=0;n<a.length;n+=e)a[n]-=a[n]%t,a[n+1]-=a[n+1]%t,a[n+2]-=a[n+2]%t;this.putImageData(i,0,0)},bw:function(t){t=128;for(var e=this.getImageData(0,0,this.width,this.height),i=e.data,a=0;a<i.length;a+=4){var n=(i[a]+i[a+1]+i[a+2])/3;n=128*(n/128|0),i[a+2]=n/255*i[a]}this.putImageData(e,0,0)},blend:function(t,e,i){if("string"==typeof t){var a=t;t=cq(this.canvas.width,this.canvas.height),t.fillStyle(a).fillRect(0,0,this.canvas.width,this.canvas.height)}var n=cq.blend(this,t,e,i);return this.canvas=n.canvas,this.context=n.context,this},textWithBackground:function(t,e,i,a,n){var s=this.measureText(t).width,r=.8*this.fontHeight(),h=this.fillStyle(),n=n||2;return this.fillStyle(a).fillRect(e-s/2-2*n,i-n,s+4*n,r+2*n),this.fillStyle(h).textAlign("center").textBaseline("top").fillText(t,e,i),this},fillCircle:function(t,e,i){return this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.fill(),this},strokeCircle:function(t,e,i){return this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.stroke(),this},circle:function(t,e,i){return this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this},crop:function(t,e,i,a){if(1===arguments.length)var e=arguments[0][1],i=arguments[0][2],a=arguments[0][3],t=arguments[0][0];var n=cq.createCanvas(i,a),s=n.getContext("2d");return s.drawImage(this.canvas,t,e,i,a,0,0,i,a),this.canvas.width=i,this.canvas.height=a,this.clear(),this.context.drawImage(n,0,0),this},set:function(t){cq.extend(this.context,t)},resize:function(t,e){var i=t,a=e;1===arguments.length?(i=arguments[0]*this.canvas.width|0,a=arguments[0]*this.canvas.height|0):e===!1?this.canvas.width>t?(a=this.canvas.height*(t/this.canvas.width)|0,i=t):(i=this.canvas.width,a=this.canvas.height):t===!1&&(this.canvas.width>t?(i=this.canvas.width*(e/this.canvas.height)|0,a=e):(i=this.canvas.width,a=this.canvas.height));var n=cq(i,a).drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,i,a);return this.canvas=n.canvas,this.context=n.context,this},imageLine:function(t,e,i,a,n,s,r){e||(e=[0,0,t.width,t.height]);var h=cq.distance(i,a,n,s),o=h/e[3]+.5|0,c=Math.atan2(s-a,n-i)+Math.PI/2;this.save(),this.translate(i,a),this.rotate(c),r&&this.scale(r,1);for(var g=0;o>=g;g++)this.drawRegion(t,e,-e[2]/2|0,-e[3]*(g+1));return this.restore(),this},trim:function(t,e){var i;t?(t=cq.color(t).toArray(),i=!t[3]):i=!0;for(var a=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),n=a.data,s=[this.canvas.width,this.canvas.height,0,0],r=this.canvas.width,h=this.canvas.height,o=0,c=n.length;c>o;o+=4){if(i){if(!n[o+3])continue}else if(n[o+0]===t[0]&&n[o+1]===t[1]&&n[o+2]===t[2])continue;var g=(o/4|0)%this.canvas.width|0,l=(o/4|0)/this.canvas.width|0;g<s[0]&&(s[0]=g),g>s[2]&&(s[2]=g),l<s[1]&&(s[1]=l),l>s[3]&&(s[3]=l)}return 0===s[2]&&0===s[3]||(e&&(e.left=s[0],e.top=s[1],e.bottom=h-s[3],e.right=r-s[2]-s[0],e.width=s[2]-s[0],e.height=s[3]-s[1]),this.crop(s[0],s[1],s[2]-s[0]+1,s[3]-s[1]+1)),this},matchPalette:function(t){for(var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=[],a=0;a<t.length;a++)i.push(cq.color(t[a]));for(var a=0;a<e.data.length;a+=4){var n=[];if(e.data[a+3]){for(var s=0;s<i.length;s++){var r=i[s],h=Math.abs(e.data[a]-r[0]),o=Math.abs(e.data[a+1]-r[1]),c=Math.abs(e.data[a+2]-r[2]);n.push(h+o+c)}for(var g=0,s=0;s<t.length;s++)n[s]<n[g]&&(g=s);var l=cq.hexToRgb(t[g]);e.data[a]=l[0],e.data[a+1]=l[1],e.data[a+2]=l[2]}}return this.context.putImageData(e,0,0),this},getPalette:function(){for(var t=[],e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.data,a=0,n=i.length;n>a;a+=4)if(i[a+3]){var s=cq.rgbToHex(i[a+0],i[a+1],i[a+2]);-1===t.indexOf(s)&&t.push(s)}return t},mapPalette:function(){},polygon:function(t){this.beginPath(),this.moveTo(t[0][0],t[0][1]);for(var e=1;e<t.length;e++)this.lineTo(t[e][0],t[e][1]);return this.closePath(),this},fillPolygon:function(t){this.beginPath(),this.polygon(t),this.fill()},strokePolygon:function(t){this.beginPath(),this.polygon(t),this.stroke()},colorToMask:function(t,e){t=cq.color(t).toArray();for(var i=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),a=i.data,n=[],s=0,r=a.length;r>s;s+=4)n.push(a[s+3]>0?e?!1:!0:e?!0:!1);return n},grayscaleToMask:function(){for(var t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),e=t.data,i=[],a=0,n=e.length;n>a;a+=4)i.push((e[a+0]+e[a+1]+e[a+2])/3/255);return i},applyMask:function(t){for(var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.data,a=("boolean"==typeof t[0]?"bool":"byte",0),n=i.length;n>a;a+=4){var s=t[a/4];i[a+3]=255*s|0}return this.context.putImageData(e,0,0),this},fillMask:function(t){var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.data,a="boolean"==typeof t[0]?"bool":"byte",n=2===arguments.length?"normal":"gradient",s=cq.color(arguments[1]);"gradient"===n&&(colorB=cq.color(arguments[2]));for(var r=0,h=i.length;h>r;r+=4){var o=t[r/4];"byte"===a&&(o/=255),"normal"===n?o&&(i[r+0]=0|s[0],i[r+1]=0|s[1],i[r+2]=0|s[2],i[r+3]=255*o|0):(i[r+0]=s[0]+(colorB[0]-s[0])*o|0,i[r+1]=s[1]+(colorB[1]-s[1])*o|0,i[r+2]=s[2]+(colorB[2]-s[2])*o|0,i[r+3]=255)}return this.context.putImageData(e,0,0),this},clear:function(t){return t?(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this},clone:function(){var t=cq.pool();return t.width=this.width,t.height=this.height,t.getContext("2d").drawImage(this.canvas,0,0),cq(t)},gradientText:function(t,e,i,a,n){var s=t.split(" "),r=2*this.fontHeight(),h=0,o=0;if(a)for(var c=0,g=[""],l=0;l<s.length;l++){var u=s[l]+" ",f=this.context.measureText(u).width;h+f>a&&(g[++c]="",h=0),g[c]+=u,h+=f}else var g=[t];for(var l=0;l<g.length;l++){for(var o=i+l*r*.6|0,m=this.context.createLinearGradient(0,o,0,o+.6*r|0),d=0;d<n.length;d+=2)m.addColorStop(n[d],n[d+1]);var t=g[l];this.fillStyle(m).fillText(t,e,o)}return this},removeColor:function(t){t=cq.color(t);for(var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.data,a=0;a<this.canvas.width;a++)for(var n=0;n<this.canvas.height;n++){var s=4*(n*this.canvas.width+a);i[s+0]===t[0]&&i[s+1]===t[1]&&i[s+2]===t[2]&&(i[s+3]=0)}return this.clear(),this.context.putImageData(e,0,0),this},outline:function(){function t(t,e){if(0>t)return 0;if(t>=s.width)return 0;if(0>e)return 0;if(e>=s.height)return 0;var a=4*(t+e*s.width);return i[a+3]>0}for(var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=e.data,a=this.createImageData(this.canvas.width,this.canvas.height),n=a.data,s=this.canvas,r=0;r<this.canvas.width;r++)for(var h=0;h<this.canvas.height;h++){var o=0,c=4*(h*s.width+r);i[c+3]&&(o+=t(r-1,h),o+=t(r+1,h),o+=t(r,h-1),o+=t(r,h+1),4!==o&&(n[c]=255,n[c+1]=255,n[c+2]=255,n[c+3]=255))}return this.context.putImageData(a,0,0),this},setHsl:function(){if(1===arguments.length)var t=arguments[0];else var t=arguments;for(var e,i,a,n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),s=n.data,r=[],h=[],o=0,c=s.length;c>o;o+=4)r=cq.rgbToHsl(s[o+0],s[o+1],s[o+2]),e=t[0]===!1?r[0]:cq.limitValue(t[0],0,1),i=t[1]===!1?r[1]:cq.limitValue(t[1],0,1),a=t[2]===!1?r[2]:cq.limitValue(t[2],0,1),h=cq.hslToRgb(e,i,a),s[o+0]=h[0],s[o+1]=h[1],s[o+2]=h[2];return this.context.putImageData(n,0,0),this},shiftHsl:function(){if(1===arguments.length)var t=arguments[0];else var t=arguments;for(var e,i,a,n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),s=n.data,r=[],h=[],o=0,c=s.length;c>o;o+=4)r=cq.rgbToHsl(s[o+0],s[o+1],s[o+2]),s[o+0]!==s[o+1]||s[o+1]!==s[o+2]?(e=t[0]===!1?r[0]:cq.wrapValue(r[0]+t[0],0,1),i=t[1]===!1?r[1]:cq.limitValue(r[1]+t[1],0,1)):(e=r[0],i=r[1]),a=t[2]===!1?r[2]:cq.limitValue(r[2]+t[2],0,1),h=cq.hslToRgb(e,i,a),s[o+0]=h[0],s[o+1]=h[1],s[o+2]=h[2];return this.context.putImageData(n,0,0),this},applyColor:function(t){return COCOONJS?this:(this.save(),this.globalCompositeOperation("source-in"),this.clear(t),this.restore(),this)},negative:function(t,e){for(var i=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),a=i.data,n=0,s=a.length;s>n;n+=4)a[n+0]=255-a[n+0],a[n+1]=255-a[n+1],a[n+2]=255-a[n+2];return this.context.putImageData(i,0,0),this},roundRect:function(t,e,i,a,n){return this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+i-n,e),this.quadraticCurveTo(t+i,e,t+i,e+n),this.lineTo(t+i,e+a-n),this.quadraticCurveTo(t+i,e+a,t+i-n,e+a),this.lineTo(t+n,e+a),this.quadraticCurveTo(t,e+a,t,e+a-n),this.lineTo(t,e+n),this.quadraticCurveTo(t,e,t+n,e),this.closePath(),this},markupText:function(t){},wrappedText:function(t,e,i,a,n){var s=t.split(" "),n=n||this.fontHeight(),r=0,h=0;if(a)for(var o=0,c=[""],g=0;g<s.length;g++){var l=s[g]+" ",u=this.context.measureText(l).width;(r+u>a||"\n"===s[g])&&(c[++o]="",r=0),"\n"!==s[g]&&(c[o]+=l,r+=u)}else var c=[t];for(var g=0;g<c.length;g++){var h=i+g*n|0,t=c[g];this.fillText(t,e,h)}return this},fontHeights:{},fontHeight:function(){var t=this.font();if(!this.fontHeights[t]){var e=cq(100,100),i=0,a={};e.font(t).fillStyle("#fff"),e.textBaseline("bottom").fillText("gM",25,100),e.trim(!1,a),i+=a.bottom;var e=cq(100,100),a={};e.font(t).fillStyle("#fff"),e.textBaseline("top").fillText("gM",25,0),e.trim(!1,a),i+=a.top;var e=cq(100,100),a={};e.font(t).fillStyle("#fff"),e.textBaseline("alphabetic").fillText("gM",50,50),e.trim(!1,a),i+=e.height,this.fontHeights[t]=i}return this.fontHeights[t]},textBoundaries:function(t,e){var i=t.split(" "),a=this.fontHeight(),n=0;if(e)for(var s=0,r=[""],h=0;h<i.length;h++){var o=i[h]+" ",c=this.context.measureText(o).width;(n+c>e||"\n"===i[h])&&(r[++s]="",n=0),"\n"!==i[h]&&(r[s]+=o,n+=c)}else{var r=[t];e=this.measureText(t).width}return{height:r.length*a,width:e,lines:r.length,lineHeight:a}},repeatImageRegion:function(t,e,i,a,n,s,r,h,o){this.save(),this.rect(s,r,h,o),this.clip();for(var c=0,g=Math.ceil(h/a);g>c;c++)for(var l=0,u=Math.ceil(o/n);u>l;l++)this.drawImage(t,e,i,a,n,s+c*a,r+l*n,a,n);return this.restore(),this},repeatImage:function(t,e,i,a,n){return arguments.length<9?this.repeatImageRegion(t,0,0,t.width,t.height,e,i,a,n):this.repeatImageRegion.apply(this,arguments),this},borderImage:function(t,e,i,a,n,s,r,h,o,c){if("object"==typeof s){var g=s.bottomLeft||[0,0,0,0],l=s.bottomRight||[0,0,0,0],u=s.topLeft||[0,0,0,0],f=s.topRight||[0,0,0,0],m=g[3]+u[3],d=l[3]+f[3],v=u[2]+f[2],p=g[2]+l[2];s.fillPadding=[0,0,0,0],s.left&&(s.fillPadding[0]=s.left[2]),s.top&&(s.fillPadding[1]=s.top[3]),s.right&&(s.fillPadding[2]=s.right[2]),s.bottom&&(s.fillPadding[3]=s.bottom[3]),s.fill&&this.drawImage(t,s.fill[0],s.fill[1],s.fill[2],s.fill[3],e+s.fillPadding[0],i+s.fillPadding[1],a-s.fillPadding[2]-s.fillPadding[0],n-s.fillPadding[3]-s.fillPadding[1]),s.left&&this["stretch"===s.left[4]?"drawImage":"repeatImage"](t,s.left[0],s.left[1],s.left[2],s.left[3],e,i+u[3],s.left[2],n-m),s.right&&this["stretch"===s.right[4]?"drawImage":"repeatImage"](t,s.right[0],s.right[1],s.right[2],s.right[3],e+a-s.right[2],i+f[3],s.right[2],n-d),s.top&&this["stretch"===s.top[4]?"drawImage":"repeatImage"](t,s.top[0],s.top[1],s.top[2],s.top[3],e+u[2],i,a-v,s.top[3]),s.bottom&&this["stretch"===s.bottom[4]?"drawImage":"repeatImage"](t,s.bottom[0],s.bottom[1],s.bottom[2],s.bottom[3],e+g[2],i+n-s.bottom[3],a-p,s.bottom[3]),s.bottomLeft&&this.drawImage(t,s.bottomLeft[0],s.bottomLeft[1],s.bottomLeft[2],s.bottomLeft[3],e,i+n-s.bottomLeft[3],s.bottomLeft[2],s.bottomLeft[3]),s.topLeft&&this.drawImage(t,s.topLeft[0],s.topLeft[1],s.topLeft[2],s.topLeft[3],e,i,s.topLeft[2],s.topLeft[3]),s.topRight&&this.drawImage(t,s.topRight[0],s.topRight[1],s.topRight[2],s.topRight[3],e+a-s.topRight[2],i,s.topRight[2],s.topRight[3]),s.bottomRight&&this.drawImage(t,s.bottomRight[0],s.bottomRight[1],s.bottomRight[2],s.bottomRight[3],e+a-s.bottomRight[2],i+n-s.bottomRight[3],s.bottomRight[2],s.bottomRight[3])}else s>0&&a-o-r>0&&this.drawImage(t,o,0,t.width-o-r,s,e+o,i,a-o-r,s),h>0&&a-o-r>0&&this.drawImage(t,o,t.height-h,t.width-o-r,h,e+o,i+n-h,a-o-r,h),o>0&&n-h-s>0&&this.drawImage(t,0,s,o,t.height-h-s,e,i+s,o,n-h-s),r>0&&n-h-s>0&&this.drawImage(t,t.width-r,s,r,t.height-h-s,e+a-r,i+s,r,n-h-s),o>0&&s>0&&this.drawImage(t,0,0,o,s,e,i,o,s),r>0&&s>0&&this.drawImage(t,t.width-r,0,r,s,e+a-r,i,r,s),r>0&&h>0&&this.drawImage(t,t.width-r,t.height-h,r,h,e+a-r,i+n-h,r,h),o>0&&h>0&&this.drawImage(t,0,t.height-h,o,h,e,i+n-h,o,h),c&&("string"==typeof c?this.fillStyle(c).fillRect(e+o,i+s,a-o-r,n-s-h):a-o-r>0&&n-s-h>0&&this.drawImage(t,o,s,t.width-r-o,t.height-h-s,e+o,i+s,a-o-r,n-s-h))},setPixel:function(t,e,i){return this.fillStyle(t).fillRect(e,i,1,1)},getPixel:function(t,e){var i=this.context.getImageData(t,e,1,1).data;return cq.color([i[0],i[1],i[2],i[3]])},createImageData:function(t,e){return this.emptyCanvas||(this.emptyCanvas=cq.createCanvas(t,e),this.emptyCanvasContext=this.emptyCanvas.getContext("2d")),this.emptyCanvas.width=t,this.emptyCanvas.height=e,this.emptyCanvasContext.getImageData(0,0,t,e)},strokeLine:function(t,e,i,a){return this.beginPath(),"undefined"==typeof i?(this.moveTo(t.x,t.y),this.lineTo(e.x,e.y)):(this.moveTo(t,e),this.lineTo(i,a)),this.stroke(),this},setLineDash:function(t){return this.context.setLineDash?(this.context.setLineDash(t),this):this},measureText:function(){return this.context.measureText.apply(this.context,arguments)},getLineDash:function(){return this.context.getLineDash()},createRadialGradient:function(){return this.context.createRadialGradient.apply(this.context,arguments)},createLinearGradient:function(){return this.context.createLinearGradient.apply(this.context,arguments)},createPattern:function(){return this.context.createPattern.apply(this.context,arguments)},getImageData:function(){return this.context.getImageData.apply(this.context,arguments)},writeMeta:function(t){var e=JSON.stringify(t);e=encodeURIComponent(e);for(var i=[],a=0;a<e.length;a++)i.push(e.charCodeAt(a));i.push(127);for(var n=this.width-1,s=this.height-1,r=[];i.length;){var h=i.shift();if(r.unshift(2*h),!i.length)for(var a=0;a<3-r.length;a++)r.unshift(254);3===r.length&&(this.fillStyle(cq.color(r).toRgb()).fillRect(n,s,1,1),r=[],n--,0>n&&(s--,n=this.width-1))}return this},readMeta:function(){for(var t=[],e=this.width-1,i=this.height-1;;){for(var a=this.getPixel(e,i),n=!1,s=0;3>s;s++)254===a[2-s]?n=!0:t.push(a[2-s]/2|0);if(n)break;if(e--,0>e){i--,e=this.width-1;break}}for(var r="";t.length;)r+=String.fromCharCode(t.shift());var h=!1;console.log(r);try{h=JSON.parse(decodeURIComponent(r))}catch(o){}return h},get width(){return this.canvas.width},get height(){return this.canvas.height},set width(t){return this.canvas.width=t,this.update(),this.canvas.width},set height(t){return this.canvas.height=t,this.update(),this.canvas.height}};for(var methods=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createRadialGradient","createPattern","drawFocusRing","drawImage","fill","fillRect","fillText","getImageData","isPointInPath","lineTo","measureText","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setTransform","stroke","strokeRect","strokeText","transform","translate","setLineDash"],i=0;i<methods.length;i++){var name=methods[i];if(!cq.Layer.prototype[name]){cq.Layer.prototype[name]=function(t){return function(){return fastApply(t,this.context,arguments),this}}(CanvasRenderingContext2D.prototype[name]);var self,self}}for(var properties=["canvas","fillStyle","font","globalAlpha","globalCompositeOperation","lineCap","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","strokeStyle","textAlign","textBaseline","lineDashOffset"],i=0;i<properties.length;i++){var name=properties[i];cq.Layer.prototype[name]||(cq.Layer.prototype[name]=Function("if(arguments.length) { this.context."+name+" = arguments[0]; return this; } else { return this.context."+name+"; }"))}cq.Color=function(t,e){arguments.length&&this.parse(t,e)},cq.Color.prototype={toString:function(){return this.toRgb()},parse:function(t,e){if(t[0]instanceof cq.Color)return this[0]=t[0][0],this[1]=t[0][1],this[2]=t[0][2],void(this[3]=t[0][3]);if("string"==typeof t){var i=null;if("#"===t[0]){var a=cq.hexToRgb(t);this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=1}else(i=t.match(/rgb\((.*),(.*),(.*)\)/))?(this[0]=0|i[1],this[1]=0|i[2],this[2]=0|i[3],this[3]=1):(i=t.match(/rgba\((.*),(.*),(.*)\)/))?(this[0]=0|i[1],this[1]=0|i[2],this[2]=0|i[3],this[3]=0|i[4]):(i=t.match(/hsl\((.*),(.*),(.*)\)/))?this.fromHsl(i[1],i[2],i[3]):(i=t.match(/hsv\((.*),(.*),(.*)\)/))&&this.fromHsv(i[1],i[2],i[3])}else switch(e){case"hsl":case"hsla":this.fromHsl(t[0],t[1],t[2],t[3]);break;case"hsv":case"hsva":this.fromHsv(t[0],t[1],t[2],t[3]);break;default:this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]="undefined"==typeof t[3]?1:t[3]}},a:function(t){return this.alpha(t)},alpha:function(t){return this[3]=t,this},fromHsl:function(){var t=arguments[0]instanceof Array?arguments[0]:arguments,e=cq.hslToRgb(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]));this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]="undefined"==typeof arguments[3]?1:arguments[3]},fromHsv:function(){var t=arguments[0]instanceof Array?arguments[0]:arguments,e=cq.hsvToRgb(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]));this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]="undefined"==typeof arguments[3]?1:arguments[3]},toArray:function(){return[this[0],this[1],this[2],this[3]]},toRgb:function(){return"rgb("+this[0]+", "+this[1]+", "+this[2]+")"},toRgba:function(){return"rgba("+this[0]+", "+this[1]+", "+this[2]+", "+this[3]+")"},toHex:function(){return cq.rgbToHex(this[0],this[1],this[2])},toHsl:function(){var t=cq.rgbToHsl(this[0],this[1],this[2]);return t[3]=this[3],t},toHsv:function(){var t=cq.rgbToHsv(this[0],this[1],this[2]);return t[3]=this[3],t},gradient:function(t,e){cq.color(t)},shiftHsl:function(){var t=this.toHsl();if(this[0]!==this[1]||this[1]!==this[2])var e=arguments[0]===!1?t[0]:cq.wrapValue(t[0]+arguments[0],0,1),i=arguments[1]===!1?t[1]:cq.limitValue(t[1]+arguments[1],0,1);else var e=t[0],i=t[1];var a=arguments[2]===!1?t[2]:cq.limitValue(t[2]+arguments[2],0,1);return this.fromHsl(e,i,a),this},setHsl:function(){var t=this.toHsl(),e=arguments[0]===!1?t[0]:cq.limitValue(arguments[0],0,1),i=arguments[1]===!1?t[1]:cq.limitValue(arguments[1],0,1),a=arguments[2]===!1?t[2]:cq.limitValue(arguments[2],0,1);return this.fromHsl(e,i,a),this},mix:function(t,e){t=cq.color(t);for(var i=0;4>i;i++)this[i]=cq.mix(this[i],t[i],e);return this}},module.exports=cq;


},{"fast-apply":1}]},{},[2])(2)
});


//# sourceMappingURL=canvasquery.js.map