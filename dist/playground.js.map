{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "src/playground.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "./src",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "/*\r\n\r\n  Playground 1.56\r\n\r\n  http://canvasquery.com\r\n\r\n  (c) 2012-2015 http://rezoner.net\r\n\r\n  Playground may be freely distributed under the MIT license.\r\n\r\n  + sound alias\r\n\r\n*/\r\n\r\nvar cq = require('canvasquery');\r\n\r\nfunction playground(args) {\r\n  return new Playground(args);\r\n};\r\n\r\n/* utitlities */\r\n\r\nplayground.extend = function() {\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    for (var j in arguments[i]) {\r\n      arguments[0][j] = arguments[i][j];\r\n    }\r\n  }\r\n\r\n  return arguments[0];\r\n};\r\n\r\nplayground.throttle = function(fn, threshold) {\r\n  threshold || (threshold = 250);\r\n  var last,\r\n    deferTimer;\r\n  return function() {\r\n    var context = this;\r\n\r\n    var now = +new Date,\r\n      args = arguments;\r\n    if (last && now < last + threshold) {\r\n      // hold on to it\r\n      clearTimeout(deferTimer);\r\n      deferTimer = setTimeout(function() {\r\n        last = now;\r\n        fn.apply(context, args);\r\n      }, threshold);\r\n    } else {\r\n      last = now;\r\n      fn.apply(context, args);\r\n    }\r\n  };\r\n};\r\n\r\n/* constructor */\r\n\r\nfunction Playground(args) {\r\n\r\n  /* defaults */\r\n\r\n  playground.extend(this, {\r\n    smoothing: 1,\r\n    scale: 1,\r\n    preventKeyboardDefault: true,\r\n    preventContextMenu: true,\r\n    paths: {\r\n      images: \"images/\"\r\n    }\r\n\r\n  }, args);\r\n\r\n  if (!this.width || !this.height) this.fitToContainer = true;\r\n\r\n  if (!this.container) this.container = document.body;\r\n  if (this.container !== document.body) this.customContainer = true;\r\n  if (typeof this.container === \"string\") this.container = document.querySelector(this.container);\r\n\r\n  /* state */\r\n\r\n  this.state = {};\r\n\r\n  /* layer */\r\n\r\n  if (!args.layer) {\r\n    cq.smoothing = this.smoothing;\r\n\r\n    if (navigator.isCocoonJS) {\r\n      this.layer = cq.cocoon(1, 1);\r\n      this.layer.appendTo(this.container);\r\n      this.screen = this.layer;\r\n    } else {\r\n      this.layer = cq(1, 1);\r\n      if (this.scaleToFit) {\r\n        this.screen = cq(1, 1);\r\n        this.screen.appendTo(this.container);\r\n      } else {\r\n        this.layer.appendTo(this.container);\r\n        this.screen = this.layer;\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  var canvas = this.screen.canvas;\r\n\r\n  /* events */\r\n\r\n  this.eventsHandler = this.eventsHandler.bind(this);\r\n\r\n  /* mouse */\r\n\r\n  this.mouse = new playground.Mouse(this, this.container);\r\n  this.mouse.on(\"event\", this.eventsHandler);\r\n\r\n  this.mouse.preventContextMenu = this.preventContextMenu;\r\n\r\n  /* touch */\r\n\r\n  this.touch = new playground.Touch(this, this.container);\r\n  this.touch.on(\"event\", this.eventsHandler);\r\n\r\n  /* keyboard */\r\n\r\n  this.keyboard = new playground.Keyboard();\r\n\r\n  this.keyboard.preventDefault = this.preventKeyboardDefault;\r\n  this.keyboard.on(\"event\", this.eventsHandler);\r\n\r\n  /* gamepads */\r\n\r\n  this.gamepads = new playground.Gamepads();\r\n  this.gamepads.on(\"event\", this.eventsHandler);\r\n\r\n  /* tweens */\r\n\r\n  this.tweens = new playground.TweenManager(this);\r\n\r\n  this.ease = playground.ease;\r\n\r\n  /* window resize */\r\n\r\n  window.addEventListener(\"resize\", this.resizeHandler.bind(this));\r\n\r\n  setTimeout(this.resizeHandler.bind(this), 1);\r\n\r\n  /* video recorder */\r\n\r\n  this.videoRecorder = new playground.VideoRecorder(this);\r\n\r\n  /* game loop */\r\n\r\n  this.lifetime = 0;\r\n  this.elapsed = 0;\r\n  this.delta = 0;\r\n\r\n  var self = this;\r\n\r\n  var lastTick = Date.now();\r\n\r\n  function step() {\r\n\r\n    requestAnimationFrame(step);\r\n\r\n    var delta = Date.now() - lastTick;\r\n    lastTick = Date.now();\r\n\r\n    if (delta > 1000) return;\r\n\r\n    var dt = delta / 1000;\r\n\r\n    self.lifetime += dt;\r\n    self.elapsed = dt;\r\n    self.delta = dt;\r\n\r\n    self.tweens.step(dt);\r\n\r\n    if (self.loader.count <= 0) {\r\n\r\n      // if (self.step) self.step(dt);\r\n      // if (self.state.step) self.state.step(dt);\r\n\r\n      self.eventsHandler(\"step\", dt)\r\n      self.eventsHandler(\"render\", dt)\r\n      self.eventsHandler(\"postrender\", dt)\r\n\r\n      // if (self.render) self.render(dt);\r\n      // if (self.state.render) self.state.render(dt);\r\n\r\n      // if (self.postrender) self.postrender(dt);\r\n      // if (self.state.postrender) self.state.postrender(dt);\r\n\r\n      self.loaderTookScreenshot = false;\r\n\r\n    } else {\r\n      self.renderLoader(dt);\r\n    }\r\n\r\n    if (self.scaleToFit) {\r\n      self.screen.save();\r\n      self.screen.translate(self.offsetX, self.offsetY);\r\n      self.screen.scale(self.scale, self.scale);\r\n      // self.layer.drawImage(self.scanlines.canvas, 0, 0);\r\n      self.screen.drawImage(self.layer.canvas, 0, 0);\r\n      self.screen.restore();\r\n    }\r\n\r\n    self.gamepads.step(dt);\r\n    self.sound.step(dt);\r\n    self.music.step(dt);\r\n    self.videoRecorder.step(dt);\r\n\r\n  };\r\n\r\n  requestAnimationFrame(step);\r\n\r\n  /* assets */\r\n\r\n  /* default audio format */\r\n\r\n  var canPlayMp3 = (new Audio).canPlayType(\"audio/mp3\");\r\n  var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\r\n  if (canPlayMp3) this.audioFormat = \"mp3\";\r\n  else this.audioFormat = \"ogg\";\r\n\r\n  this.loader = new playground.Loader();\r\n\r\n  this.images = {};\r\n  this.atlases = {};\r\n  this.data = {};\r\n\r\n  var audioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext;\r\n\r\n  if (audioContext) {\r\n    this.audioContext = new audioContext;\r\n    this.sound = new Playground.Sound(this, this.audioContext);\r\n    this.music = new Playground.Sound(this, this.audioContext);\r\n  } else {\r\n    this.sound = new Playground.SoundFallback(this);\r\n    this.music = new Playground.SoundFallback(this);\r\n  }\r\n\r\n  this.loadFoo(0.5);\r\n\r\n  if (this.create) setTimeout(this.create.bind(this));\r\n\r\n  this.loader.on(\"ready\", function() {\r\n    self.foofooLoader = 0;\r\n  });\r\n\r\n  this.loader.once(\"ready\", function() {\r\n    if (self.ready) self.ready();\r\n\r\n    self.ready = function() {};\r\n  });\r\n\r\n\r\n\r\n};\r\n\r\nPlayground.prototype = {\r\n\r\n  setState: function(state) {\r\n    state.app = this;\r\n\r\n    if (this.state) this.screenshot = this.layer.cache();\r\n    if (this.state && this.state.leave) this.state.leave();\r\n\r\n    this.state = state;\r\n\r\n    if (this.state && this.state.enter) this.state.enter();\r\n  },\r\n\r\n  eventsHandler: function(event, data) {\r\n\r\n    if (this[event]) this[event](data);\r\n    if (this.state[event]) this.state[event](data);\r\n    if (this.state.proxy) this.state.proxy(event, data);\r\n\r\n  },\r\n\r\n  resizeHandler: function() {\r\n\r\n    if (this.customContainer) {\r\n      var containerWidth = this.container.offsetWidth;\r\n      var containerHeight = this.container.offsetHeight;\r\n    } else {\r\n      var containerWidth = window.innerWidth;\r\n      var containerHeight = window.innerHeight;\r\n    }\r\n\r\n    if (this.fitToContainer) {\r\n      this.width = this.containerWidth;\r\n      this.height = this.containerHeight;\r\n    }\r\n\r\n    if (!this.scaleToFit) {\r\n\r\n      if (this.fitToContainer) {\r\n        this.width = containerWidth;\r\n        this.height = containerHeight;\r\n      }\r\n\r\n      this.offsetX = 0;\r\n      this.offsetY = 0;\r\n\r\n    } else {\r\n\r\n      this.screen.width = containerWidth;\r\n      this.screen.height = containerHeight;\r\n\r\n      this.scale = Math.min(containerWidth / this.width, containerHeight / this.height);\r\n\r\n      if (this.roundScale) this.scale = Math.max(1, Math.floor(this.scale));\r\n\r\n      this.offsetX = containerWidth / 2 - this.scale * (this.width / 2) | 0;\r\n      this.offsetY = containerHeight / 2 - this.scale * (this.height / 2) | 0;\r\n\r\n      this.mouse.scale = this.scale;\r\n      this.mouse.offsetX = this.offsetX;\r\n      this.mouse.offsetY = this.offsetY;\r\n\r\n      this.touch.scale = this.scale;\r\n      this.touch.offsetX = this.offsetX;\r\n      this.touch.offsetY = this.offsetY;\r\n    }\r\n\r\n    this.layer.width = this.width;\r\n    this.layer.height = this.height;\r\n\r\n    this.center = {\r\n      x: this.width / 2 | 0,\r\n      y: this.height / 2 | 0\r\n    };\r\n\r\n    this.screen.clear(\"#000\");\r\n\r\n    this.eventsHandler(\"resize\");\r\n\r\n    this.mouse.update();\r\n    this.touch.update();\r\n  },\r\n\r\n  renderLoader: function() {\r\n\r\n    var height = this.height / 10 | 0;\r\n    var x = 32;\r\n    var width = this.width - x * 2;\r\n    var y = this.height / 2 - height / 2 | 0;\r\n\r\n    if (!this.loaderTookScreenshot) {\r\n      this.loaderTookScreenshot = true;\r\n      this.screenshot = this.layer.cache();\r\n    }\r\n\r\n    this.layer.clear(\"#000\");\r\n    if (this.screenshot) {\r\n      this.layer.drawImage(this.screenshot, 0, 0);\r\n      this.layer.clear(\"rgba(0,0,0,0.4)\");\r\n    }\r\n\r\n    this.layer.strokeStyle(\"#fff\").lineWidth(2).strokeRect(x, y, width, height);\r\n    this.layer.fillStyle(\"#fff\").fillRect(x, y, width * this.loader.progress | 0, height);\r\n\r\n  },\r\n\r\n  record: function(args) {\r\n    this.videoRecorder.toggle(args);\r\n  },\r\n\r\n  /* imaginary timeout to delay loading */\r\n\r\n  loadFoo: function(timeout) {\r\n    if (!this.foofooLoader) this.foofooLoader = 0;\r\n\r\n    var loader = this.loader;\r\n\r\n    this.loader.add(\"foo \" + timeout);\r\n\r\n    setTimeout(function() {\r\n      loader.ready(\"foo \" + timeout);\r\n    }, (this.foofooLoader += timeout * 1000));\r\n\r\n  },\r\n\r\n  loadAtlases: function() {\r\n\r\n\r\n    for (var i = 0; i < arguments.length; i++) {\r\n\r\n      var arg = arguments[i];\r\n\r\n      /* polymorphism at its finest */\r\n\r\n      if (typeof arg === \"object\") {\r\n\r\n        for (var key in arg) this.loadAtlases(arg[key]);\r\n\r\n      } else {\r\n\r\n        /* if argument is not an object/array let's try to load it */\r\n\r\n        this._loadAtlas(arg)\r\n\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  loadAtlas: function() {\r\n    return this.loadAtlases.apply(this, arguments);\r\n  },\r\n\r\n  _loadAtlas: function(filename) {\r\n\r\n    var fileinfo = filename.match(/(.*)\\..*/);\r\n    var key = fileinfo ? fileinfo[1] : filename;\r\n\r\n    var loader = this.loader;\r\n\r\n    /* filename defaults to png */\r\n\r\n    if (!fileinfo) filename += \".png\";\r\n\r\n    var path = \"atlases/\" + filename;\r\n\r\n    this.loader.add(path);\r\n\r\n    var atlas = this.atlases[key] = {};\r\n\r\n    var image = atlas.image = new Image;\r\n\r\n    image.addEventListener(\"load\", function() {\r\n      loader.ready(path);\r\n    });\r\n\r\n    image.addEventListener(\"error\", function() {\r\n      loader.error(path);\r\n    });\r\n\r\n    image.src = path;\r\n\r\n    /* data */\r\n\r\n    var url = \"atlases/\" + key + \".json\";\r\n\r\n    var request = new XMLHttpRequest();\r\n\r\n    request.open(\"GET\", url, true);\r\n\r\n    this.loader.add(url);\r\n\r\n    request.onload = function() {\r\n\r\n      var data = JSON.parse(this.response);\r\n\r\n      atlas.frames = [];\r\n\r\n      console.log(data.frames, atlas, key, url)\r\n\r\n      for (var i = 0; i < data.frames.length; i++) {\r\n        var frame = data.frames[i];\r\n\r\n        atlas.frames.push({\r\n          region: [frame.frame.x, frame.frame.y, frame.frame.w, frame.frame.h],\r\n          offset: [frame.spriteSourceSize.x || 0, frame.spriteSourceSize.y || 0],\r\n          width: frame.sourceSize.w,\r\n          height: frame.sourceSize.h\r\n        });\r\n      }\r\n\r\n      loader.ready(url);\r\n\r\n    }\r\n\r\n    request.send();\r\n  },\r\n\r\n  /* data/json */\r\n\r\n  loadData: function() {\r\n\r\n    for (var i = 0; i < arguments.length; i++) {\r\n\r\n      var arg = arguments[i];\r\n\r\n      if (typeof arg === \"object\") {\r\n\r\n        for (var key in arg) this.loadData(arg[key]);\r\n\r\n      } else {\r\n\r\n        var filename = arg;\r\n        var fileinfo = filename.match(/(.*)\\..*/);\r\n        var key = fileinfo ? fileinfo[1] : filename;\r\n\r\n        if (!fileinfo) {\r\n          filename += \".json\";\r\n        }\r\n\r\n        var ext = filename.split(\".\").pop();\r\n\r\n        var url = \"data/\" + filename;\r\n\r\n        var request = new XMLHttpRequest();\r\n\r\n        var app = this;\r\n\r\n        request.open(\"GET\", url, true);\r\n\r\n        this.loader.add(url);\r\n\r\n        request.onload = function() {\r\n\r\n          if (ext === \"json\") {\r\n            app.data[key] = JSON.parse(this.responseText);\r\n          } else {\r\n            app.data[key] = this.responseText;\r\n          }\r\n\r\n          app.loader.ready(url);\r\n        }\r\n\r\n        request.send();\r\n\r\n      }\r\n    }\r\n  },\r\n\r\n  /* images */\r\n\r\n  loadImage: function() {\r\n    return this.loadImages.apply(this, arguments);\r\n  },\r\n\r\n  loadImages: function() {\r\n\r\n    for (var i = 0; i < arguments.length; i++) {\r\n\r\n      var arg = arguments[i];\r\n\r\n      /* polymorphism at its finest */\r\n\r\n      if (typeof arg === \"object\") {\r\n\r\n        for (var key in arg) this.loadImages(arg[key]);\r\n\r\n      } else {\r\n\r\n        /* if argument is not an object/array let's try to load it */\r\n\r\n        var filename = arg;\r\n\r\n        var loader = this.loader;\r\n\r\n        var fileinfo = filename.match(/(.*)\\..*/);\r\n        var key = fileinfo ? fileinfo[1] : filename;\r\n\r\n        /* filename defaults to png */\r\n\r\n        if (!fileinfo) filename += \".png\";\r\n\r\n        var path = this.paths.images + filename;\r\n\r\n        this.loader.add(path);\r\n\r\n        var image = this.images[key] = new Image;\r\n\r\n        image.addEventListener(\"load\", function() {\r\n          loader.ready(path);\r\n        });\r\n\r\n        image.addEventListener(\"error\", function() {\r\n          loader.error(path);\r\n        });\r\n\r\n        image.src = path;\r\n      }\r\n    }\r\n  },\r\n\r\n  /* sounds */\r\n\r\n  loadSound: function() {\r\n    return this.loadSounds.apply(this, arguments);\r\n  },\r\n\r\n  loadSounds: function() {\r\n\r\n    for (var i = 0; i < arguments.length; i++) {\r\n\r\n      var arg = arguments[i];\r\n\r\n      /* polymorphism at its finest */\r\n\r\n      if (typeof arg === \"object\") {\r\n\r\n        for (var key in arg) this.loadSounds(arg[key]);\r\n\r\n      } else {\r\n        this.sound.load(arg);\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  loadFont: function(name) {\r\n    var styleNode = document.createElement(\"style\");\r\n    styleNode.type = \"text/css\";\r\n\r\n    var formats = {\r\n      \"woff\": \"woff\",\r\n      \"ttf\": \"truetype\"\r\n    };\r\n\r\n    var sources = \"\";\r\n\r\n    for (var ext in formats) {\r\n      var type = formats[ext];\r\n      sources += \" url(\\\"fonts/\" + name + \".\" + ext + \"\\\") format('\" + type + \"');\"\r\n    }\r\n\r\n    styleNode.textContent = \"@font-face { font-family: '\" + name + \"'; src: \" + sources + \" }\";\r\n\r\n    document.head.appendChild(styleNode);\r\n\r\n    var layer = cq(32, 32);\r\n\r\n    layer.font(\"10px huj\");\r\n    layer.fillText(16, 16, 16).trim();\r\n\r\n    var width = layer.width;\r\n    var height = layer.height;\r\n\r\n    this.loader.add(\"font \" + name);\r\n\r\n    var self = this;\r\n\r\n    function check() {\r\n      var layer = cq(32, 32);\r\n      layer.font(\"10px \" + name).fillText(16, 16, 16);\r\n      layer.trim();\r\n\r\n      if (layer.width !== width || layer.height !== height) {\r\n        self.loader.ready(\"font \" + name);\r\n      } else {\r\n        setTimeout(check, 250);\r\n      }\r\n    };\r\n\r\n    check();\r\n  },\r\n\r\n  playSound: function(key, loop) {\r\n\r\n    if (!this.audioChannels) {\r\n      this.audioChannels = [];\r\n\r\n      for (var i = 0; i < 16; i++) this.audioChannels.push(new Audio);\r\n\r\n      this.audioChannelIndex = 0;\r\n    }\r\n\r\n    return this.sound.play(key, loop);\r\n\r\n  },\r\n\r\n  stopSound: function(sound) {\r\n    this.sound.stop(sound);\r\n  }\r\n\r\n\r\n};\r\n\r\nplayground.Events = function() {\r\n\r\n  this.listeners = {};\r\n\r\n};\r\n\r\nplayground.Events.prototype = {\r\n\r\n  on: function(event, callback) {\r\n    if (!this.listeners[event]) this.listeners[event] = [];\r\n\r\n    this.listeners[event].push(callback);\r\n\r\n    return callback;\r\n  },\r\n\r\n  once: function(event, callback) {\r\n    callback.once = true;\r\n\r\n    if (!this.listeners[event]) this.listeners[event] = [];\r\n\r\n    this.listeners[event].push(callback);\r\n\r\n    return callback;\r\n  },\r\n\r\n  off: function(event, callback) {\r\n    for (var i = 0, len = this.listeners[event].length; i < len; i++) {\r\n      if (this.listeners[event][i]._remove) {\r\n        this.listeners[event].splice(i--, 1);\r\n        len--;\r\n      }\r\n    }\r\n  },\r\n\r\n  trigger: function(event, data) {\r\n\r\n    /* if you prefer events pipe */\r\n\r\n    if (this.listeners[\"event\"]) {\r\n      for (var i = 0, len = this.listeners[\"event\"].length; i < len; i++) {\r\n        this.listeners[\"event\"][i](event, data);\r\n      }\r\n    }\r\n\r\n    /* or subscribed to single event */\r\n\r\n    if (this.listeners[event]) {\r\n      for (var i = 0, len = this.listeners[event].length; i < len; i++) {\r\n        var listener = this.listeners[event][i];\r\n        listener(data);\r\n\r\n        if (listener.once) {\r\n          this.listeners[event].splice(i--, 1);\r\n          len--;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/* Mouse */\r\n\r\nplayground.Mouse = function(parent, element) {\r\n\r\n  var self = this;\r\n  this.parent = parent;\r\n\r\n\r\n  playground.Events.call(this);\r\n\r\n  this.element = element;\r\n\r\n  this.buttons = {};\r\n\r\n  this.mousemoveEvent = {};\r\n  this.mousedownEvent = {};\r\n  this.mouseupEvent = {};\r\n  this.mousewheelEvent = {};\r\n\r\n  this.x = 0;\r\n  this.y = 0;\r\n\r\n  this.offsetX = 0;\r\n  this.offsetY = 0;\r\n  this.scale = 1;\r\n\r\n  element.addEventListener(\"mousemove\", this.mousemove.bind(this));\r\n  element.addEventListener(\"mousedown\", this.mousedown.bind(this));\r\n  element.addEventListener(\"mouseup\", this.mouseup.bind(this));\r\n\r\n  this.enableMousewheel();\r\n\r\n  this.element.addEventListener(\"contextmenu\", function(e) {\r\n    if (self.preventContextMenu) e.preventDefault();\r\n  });\r\n\r\n  element.requestPointerLock = element.requestPointerLock ||\r\n    element.mozRequestPointerLock ||\r\n    element.webkitRequestPointerLock;\r\n\r\n  document.exitPointerLock = document.exitPointerLock ||\r\n    document.mozExitPointerLock ||\r\n    document.webkitExitPointerLock;\r\n};\r\n\r\nplayground.Mouse.prototype = {\r\n\r\n  lock: function() {\r\n    this.locked = true;\r\n    this.element.requestPointerLock();\r\n  },\r\n\r\n  unlock: function() {\r\n    this.locked = false;\r\n    document.exitPointerLock();\r\n  },\r\n\r\n  getElementOffset: function(element) {\r\n\r\n    var offsetX = 0;\r\n    var offsetY = 0;\r\n\r\n    do {\r\n      offsetX += element.offsetLeft;\r\n      offsetY += element.offsetTop;\r\n    }\r\n\r\n    while ((element = element.offsetParent));\r\n\r\n    return {\r\n      x: offsetX,\r\n      y: offsetY\r\n    };\r\n\r\n  },\r\n\r\n  update: function() {\r\n    this.elementOffset = this.getElementOffset(this.element);\r\n  },\r\n\r\n  mousemove: playground.throttle(function(e) {\r\n\r\n    this.x = this.mousemoveEvent.x = (e.pageX - this.elementOffset.x - this.offsetX) / this.scale | 0;\r\n    this.y = this.mousemoveEvent.y = (e.pageY - this.elementOffset.y - this.offsetY) / this.scale | 0;\r\n\r\n    this.mousemoveEvent.original = e;\r\n\r\n    if (this.locked) {\r\n      this.mousemoveEvent.movementX = e.movementX ||\r\n        e.mozMovementX ||\r\n        e.webkitMovementX ||\r\n        0;\r\n\r\n      this.mousemoveEvent.movementY = e.movementY ||\r\n        e.mozMovementY ||\r\n        e.webkitMovementY ||\r\n        0;\r\n    }\r\n\r\n    if (this.parent.mouseToTouch) {\r\n      //      if (this.left) {\r\n      this.mousemoveEvent.identifier = this.parent.keyboard.keys.ctrl ? 1 : 0;\r\n      this.trigger(\"touchmove\", this.mousemoveEvent);\r\n      //      }\r\n    } else {\r\n      this.trigger(\"mousemove\", this.mousemoveEvent);\r\n    }\r\n\r\n  }, 16),\r\n\r\n  mousedown: function(e) {\r\n\r\n    var buttonName = [\"left\", \"middle\", \"right\"][e.button];\r\n\r\n    this.mousedownEvent.x = this.mousemoveEvent.x;\r\n    this.mousedownEvent.y = this.mousemoveEvent.y;\r\n    this.mousedownEvent.button = buttonName;\r\n    this.mousedownEvent.original = e;\r\n\r\n    this[buttonName] = true;\r\n\r\n    if (this.parent.mouseToTouch) {\r\n      this.mousedownEvent.identifier = this.parent.keyboard.keys.ctrl ? 1 : 0;\r\n      this.trigger(\"touchmove\", this.mousedownEvent);\r\n      this.trigger(\"touchstart\", this.mousedownEvent);\r\n    } else {\r\n      this.trigger(\"mousedown\", this.mousedownEvent);\r\n    }\r\n\r\n  },\r\n\r\n  mouseup: function(e) {\r\n\r\n    var buttonName = [\"left\", \"middle\", \"right\"][e.button];\r\n\r\n    this.mouseupEvent.x = this.mousemoveEvent.x;\r\n    this.mouseupEvent.y = this.mousemoveEvent.y;\r\n    this.mouseupEvent.button = buttonName;\r\n    this.mouseupEvent.original = e;\r\n\r\n    this[buttonName] = false;\r\n\r\n    if (this.parent.mouseToTouch) {\r\n      this.mouseupEvent.identifier = this.parent.keyboard.keys.ctrl ? 1 : 0;\r\n      this.trigger(\"touchend\", this.mouseupEvent);\r\n    } else {\r\n      this.trigger(\"mouseup\", this.mouseupEvent);\r\n    }\r\n  },\r\n\r\n  mousewheel: function(e) {\r\n    this.mousewheelEvent.x = this.mousemoveEvent.x;\r\n    this.mousewheelEvent.y = this.mousemoveEvent.y;\r\n    this.mousewheelEvent.button = [\"none\", \"left\", \"middle\", \"right\"][e.button];\r\n    this.mousewheelEvent.original = e;\r\n    this.mousewheelEvent.identifier = 0;\r\n\r\n    this[e.button] = false;\r\n\r\n    this.trigger(\"mousewheel\", this.mousewheelEvent);\r\n  },\r\n\r\n\r\n  enableMousewheel: function() {\r\n\r\n    var eventNames = 'onwheel' in document || document.documentMode >= 9 ? ['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'];\r\n    var callback = this.mousewheel.bind(this);\r\n    var self = this;\r\n\r\n    for (var i = eventNames.length; i;) {\r\n\r\n      self.element.addEventListener(eventNames[--i], playground.throttle(function(event) {\r\n\r\n        var orgEvent = event || window.event,\r\n          args = [].slice.call(arguments, 1),\r\n          delta = 0,\r\n          deltaX = 0,\r\n          deltaY = 0,\r\n          absDelta = 0,\r\n          absDeltaXY = 0,\r\n          fn;\r\n\r\n        event.type = \"mousewheel\";\r\n\r\n        // Old school scrollwheel delta\r\n        if (orgEvent.wheelDelta) {\r\n          delta = orgEvent.wheelDelta;\r\n        }\r\n\r\n        if (orgEvent.detail) {\r\n          delta = orgEvent.detail * -1;\r\n        }\r\n\r\n        // New school wheel delta (wheel event)\r\n        if (orgEvent.deltaY) {\r\n          deltaY = orgEvent.deltaY * -1;\r\n          delta = deltaY;\r\n        }\r\n\r\n        // Webkit\r\n        if (orgEvent.wheelDeltaY !== undefined) {\r\n          deltaY = orgEvent.wheelDeltaY;\r\n        }\r\n\r\n        var result = delta ? delta : deltaY;\r\n\r\n        self.mousewheelEvent.x = self.mousemoveEvent.x;\r\n        self.mousewheelEvent.y = self.mousemoveEvent.y;\r\n        self.mousewheelEvent.delta = result / Math.abs(result);\r\n        self.mousewheelEvent.original = orgEvent;\r\n\r\n        callback(self.mousewheelEvent);\r\n\r\n        event.preventDefault();\r\n\r\n      }, 40), false);\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nplayground.extend(playground.Mouse.prototype, playground.Events.prototype);\r\n\r\n/* Touch */\r\n\r\nplayground.Touch = function(parent, element) {\r\n\r\n  playground.Events.call(this);\r\n\r\n  this.parent = parent;\r\n\r\n\r\n  this.element = element;\r\n\r\n  this.buttons = {};\r\n\r\n  this.touchmoveEvent = {};\r\n  this.touchstartEvent = {};\r\n  this.touchendEvent = {};\r\n\r\n  this.touches = {};\r\n\r\n  this.x = 0;\r\n  this.y = 0;\r\n\r\n  this.offsetX = 0;\r\n  this.offsetY = 0;\r\n  this.scale = 1;\r\n\r\n  element.addEventListener(\"touchmove\", this.touchmove.bind(this));\r\n  element.addEventListener(\"touchstart\", this.touchstart.bind(this));\r\n  element.addEventListener(\"touchend\", this.touchend.bind(this));\r\n};\r\n\r\nplayground.Touch.prototype = {\r\n\r\n  getElementOffset: function(element) {\r\n\r\n    var offsetX = 0;\r\n    var offsetY = 0;\r\n\r\n    do {\r\n      offsetX += element.offsetLeft;\r\n      offsetY += element.offsetTop;\r\n    }\r\n\r\n    while ((element = element.offsetParent));\r\n\r\n    return {\r\n      x: offsetX,\r\n      y: offsetY\r\n    };\r\n\r\n  },\r\n\r\n  update: function() {\r\n    this.elementOffset = this.getElementOffset(this.element);\r\n  },\r\n\r\n  touchmove: function(e) {\r\n\r\n    for (var i = 0; i < e.changedTouches.length; i++) {\r\n\r\n      var touch = e.changedTouches[i];\r\n\r\n      this.x = this.touchmoveEvent.x = (touch.pageX - this.elementOffset.x - this.offsetX) / this.scale | 0;\r\n      this.y = this.touchmoveEvent.y = (touch.pageY - this.elementOffset.y - this.offsetY) / this.scale | 0;\r\n\r\n      this.touchmoveEvent.original = touch;\r\n      this.touchmoveEvent.identifier = touch.identifier;\r\n\r\n      this.touches[touch.identifier].x = this.touchmoveEvent.x;\r\n      this.touches[touch.identifier].y = this.touchmoveEvent.y;\r\n\r\n      this.trigger(\"touchmove\", this.touchmoveEvent);\r\n\r\n      e.preventDefault();\r\n    }\r\n  },\r\n\r\n  touchstart: function(e) {\r\n\r\n    for (var i = 0; i < e.changedTouches.length; i++) {\r\n\r\n      var touch = e.changedTouches[i];\r\n\r\n      this.x = this.touchstartEvent.x = (touch.pageX - this.elementOffset.x - this.offsetX) / this.scale | 0;\r\n      this.y = this.touchstartEvent.y = (touch.pageY - this.elementOffset.y - this.offsetY) / this.scale | 0;\r\n\r\n      this.touchstartEvent.original = e.touch;\r\n      this.touchstartEvent.identifier = touch.identifier;\r\n\r\n      this.touches[touch.identifier] = {\r\n        x: this.touchstartEvent.x,\r\n        y: this.touchstartEvent.y\r\n      };\r\n\r\n      this.trigger(\"touchstart\", this.touchstartEvent);\r\n    }\r\n\r\n  },\r\n\r\n  touchend: function(e) {\r\n    for (var i = 0; i < e.changedTouches.length; i++) {\r\n\r\n      var touch = e.changedTouches[i];\r\n\r\n      this.touchendEvent.x = (touch.pageX - this.elementOffset.x - this.offsetX) / this.scale | 0;\r\n      this.touchendEvent.y = (touch.pageY - this.elementOffset.y - this.offsetY) / this.scale | 0;\r\n\r\n      this.touchendEvent.original = touch;\r\n      this.touchendEvent.identifier = touch.identifier;\r\n\r\n      delete this.touches[touch.identifier];\r\n\r\n      this.trigger(\"touchend\", this.touchendEvent);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nplayground.extend(playground.Touch.prototype, playground.Events.prototype);\r\n\r\n/* Keyboard */\r\n\r\nplayground.Keyboard = function() {\r\n\r\n  playground.Events.call(this);\r\n\r\n  this.keys = {};\r\n\r\n  document.addEventListener(\"keydown\", this.keydown.bind(this));\r\n  document.addEventListener(\"keyup\", this.keyup.bind(this));\r\n  document.addEventListener(\"keypress\", this.keypress.bind(this));\r\n\r\n  this.keydownEvent = {};\r\n  this.keyupEvent = {};\r\n\r\n};\r\n\r\nplayground.Keyboard.prototype = {\r\n\r\n  keycodes: {\r\n    37: \"left\",\r\n    38: \"up\",\r\n    39: \"right\",\r\n    40: \"down\",\r\n    45: \"insert\",\r\n    46: \"delete\",\r\n    8: \"backspace\",\r\n    9: \"tab\",\r\n    13: \"enter\",\r\n    16: \"shift\",\r\n    17: \"ctrl\",\r\n    18: \"alt\",\r\n    19: \"pause\",\r\n    20: \"capslock\",\r\n    27: \"escape\",\r\n    32: \"space\",\r\n    33: \"pageup\",\r\n    34: \"pagedown\",\r\n    35: \"end\",\r\n    36: \"home\",\r\n    112: \"f1\",\r\n    113: \"f2\",\r\n    114: \"f3\",\r\n    115: \"f4\",\r\n    116: \"f5\",\r\n    117: \"f6\",\r\n    118: \"f7\",\r\n    119: \"f8\",\r\n    120: \"f9\",\r\n    121: \"f10\",\r\n    122: \"f11\",\r\n    123: \"f12\",\r\n    144: \"numlock\",\r\n    145: \"scrolllock\",\r\n    186: \"semicolon\",\r\n    187: \"equal\",\r\n    188: \"comma\",\r\n    189: \"dash\",\r\n    190: \"period\",\r\n    191: \"slash\",\r\n    192: \"graveaccent\",\r\n    219: \"openbracket\",\r\n    220: \"backslash\",\r\n    221: \"closebraket\",\r\n    222: \"singlequote\"\r\n  },\r\n\r\n  keypress: function(e) {\r\n\r\n  },\r\n\r\n  keydown: function(e) {\r\n    if (e.which >= 48 && e.which <= 90) var keyName = String.fromCharCode(e.which).toLowerCase();\r\n    else var keyName = this.keycodes[e.which];\r\n\r\n    if (this.keys[keyName]) return;\r\n\r\n    this.keydownEvent.key = keyName;\r\n    this.keydownEvent.original = e;\r\n\r\n    this.keys[keyName] = true;\r\n\r\n    this.trigger(\"keydown\", this.keydownEvent);\r\n\r\n    if (this.preventDefault && document.activeElement === document.body) {\r\n      e.returnValue = false;\r\n      e.keyCode = 0;\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  },\r\n\r\n  keyup: function(e) {\r\n\r\n    if (e.which >= 48 && e.which <= 90) var keyName = String.fromCharCode(e.which).toLowerCase();\r\n    else var keyName = this.keycodes[e.which];\r\n\r\n    this.keyupEvent.key = keyName;\r\n    this.keyupEvent.original = e;\r\n\r\n    this.keys[keyName] = false;\r\n\r\n    this.trigger(\"keyup\", this.keyupEvent);\r\n  }\r\n\r\n};\r\n\r\nplayground.extend(playground.Keyboard.prototype, playground.Events.prototype);\r\n\r\n/* Gamepad */\r\n\r\nplayground.Gamepads = function() {\r\n\r\n  playground.Events.call(this);\r\n\r\n  this.getGamepads = navigator.getGamepads || navigator.webkitGetGamepads;\r\n\r\n  this.gamepadmoveEvent = {};\r\n  this.gamepaddownEvent = {};\r\n  this.gamepadupEvent = {};\r\n\r\n  this.gamepads = {};\r\n\r\n};\r\n\r\nplayground.Gamepads.prototype = {\r\n\r\n  buttons: {\r\n    0: \"1\",\r\n    1: \"2\",\r\n    2: \"3\",\r\n    3: \"4\",\r\n    4: \"l1\",\r\n    5: \"r1\",\r\n    6: \"l2\",\r\n    7: \"r2\",\r\n    8: \"select\",\r\n    9: \"start\",\r\n    12: \"up\",\r\n    13: \"down\",\r\n    14: \"left\",\r\n    15: \"right\"\r\n  },\r\n\r\n  zeroState: function() {\r\n    var buttons = [];\r\n\r\n    for (var i = 0; i <= 15; i++) {\r\n      buttons.push({\r\n        pressed: false,\r\n        value: 0\r\n      });\r\n    }\r\n\r\n    return {\r\n      axes: [],\r\n      buttons: buttons\r\n    };\r\n  },\r\n\r\n  createGamepad: function() {\r\n    var result = {\r\n      buttons: {},\r\n      sticks: [{\r\n        x: 0,\r\n        y: 0\r\n      }, {\r\n        x: 0,\r\n        y: 0\r\n      }]\r\n    };\r\n\r\n\r\n    for (var i = 0; i < 16; i++) {\r\n      var key = this.buttons[i];\r\n      result.buttons[key] = false;\r\n    }\r\n\r\n    return result;\r\n  },\r\n\r\n  step: function() {\r\n    if (!navigator.getGamepads) return;\r\n\r\n    var gamepads = navigator.getGamepads();\r\n\r\n    for (var i = 0; i < gamepads.length; i++) {\r\n      var current = gamepads[i];\r\n\r\n      if (!current) continue;\r\n\r\n      if (!this[i]) this[i] = this.createGamepad();\r\n\r\n      /* have to concat the current.buttons because the are read-only */\r\n\r\n      var buttons = [].concat(current.buttons);\r\n\r\n      /* hack for missing  dpads */\r\n\r\n      for (var h = 12; h <= 15; h++) {\r\n        if (!buttons[h]) buttons[h] = {\r\n          pressed: false,\r\n          value: 0\r\n        };\r\n      }\r\n\r\n      var previous = this[i];\r\n\r\n      /* axes (sticks) to buttons */\r\n\r\n      if (current.axes) {\r\n\r\n        if (current.axes[0] < 0) buttons[14].pressed = true;\r\n        if (current.axes[0] > 0) buttons[15].pressed = true;\r\n        if (current.axes[1] < 0) buttons[12].pressed = true;\r\n        if (current.axes[1] > 0) buttons[13].pressed = true;\r\n\r\n        previous.sticks[0].x = current.axes[0].value;\r\n        previous.sticks[0].y = current.axes[1].value;\r\n        previous.sticks[1].x = current.axes[2].value;\r\n        previous.sticks[1].y = current.axes[3].value;\r\n\r\n      }\r\n\r\n      /* check buttons changes */\r\n\r\n      for (var j = 0; j < buttons.length; j++) {\r\n\r\n        var key = this.buttons[j];\r\n\r\n        /* gamepad down */\r\n\r\n        if (buttons[j].pressed && !previous.buttons[key]) {\r\n          previous.buttons[key] = true;\r\n          this.gamepaddownEvent.button = this.buttons[j];\r\n          this.gamepaddownEvent.gamepad = i;\r\n          this.trigger(\"gamepaddown\", this.gamepaddownEvent);\r\n        }\r\n\r\n        /* gamepad up */\r\n        else if (!buttons[j].pressed && previous.buttons[key]) {\r\n          previous.buttons[key] = false;\r\n          this.gamepadupEvent.button = this.buttons[j];\r\n          this.gamepadupEvent.gamepad = i;\r\n          this.trigger(\"gamepadup\", this.gamepadupEvent);\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\nplayground.extend(playground.Gamepads.prototype, playground.Events.prototype);\r\n\r\n\r\n/* Loader */\r\n\r\nplayground.Loader = function() {\r\n\r\n  playground.Events.call(this);\r\n\r\n  this.reset();\r\n\r\n};\r\n\r\nplayground.Loader.prototype = {\r\n\r\n  /* loader */\r\n\r\n  add: function(id) {\r\n    this.queue++;\r\n    this.count++;\r\n    this.trigger(\"add\", id);\r\n  },\r\n\r\n  error: function(id) {\r\n    console.log(\"unable to load \" + id);\r\n    this.trigger(\"error\", id);\r\n  },\r\n\r\n  ready: function(id) {\r\n\r\n    this.queue--;\r\n\r\n    this.progress = 1 - this.queue / this.count;\r\n\r\n    this.trigger(\"load\", id);\r\n\r\n    if (this.queue <= 0) {\r\n      this.trigger(\"ready\");\r\n      this.reset();\r\n    }\r\n  },\r\n\r\n  reset: function() {\r\n    this.progress = 0;\r\n    this.queue = 0;\r\n    this.count = 0;\r\n  }\r\n};\r\n\r\nplayground.extend(playground.Loader.prototype, playground.Events.prototype);\r\n\r\nCanvasQuery.Layer.prototype.playground = function(args) {\r\n  args.layer = this;\r\n  return playground(args);\r\n};\r\n\r\n/* Video recorder */\r\n\r\n/* whammy - https://github.com/antimatter15/whammy */\r\n\r\nwindow.Whammy = function() {\r\n  function h(a, b) {\r\n    for (var c = r(a), c = [{\r\n        id: 440786851,\r\n        data: [{\r\n          data: 1,\r\n          id: 17030\r\n        }, {\r\n          data: 1,\r\n          id: 17143\r\n        }, {\r\n          data: 4,\r\n          id: 17138\r\n        }, {\r\n          data: 8,\r\n          id: 17139\r\n        }, {\r\n          data: \"webm\",\r\n          id: 17026\r\n        }, {\r\n          data: 2,\r\n          id: 17031\r\n        }, {\r\n          data: 2,\r\n          id: 17029\r\n        }]\r\n      }, {\r\n        id: 408125543,\r\n        data: [{\r\n          id: 357149030,\r\n          data: [{\r\n            data: 1E6,\r\n            id: 2807729\r\n          }, {\r\n            data: \"whammy\",\r\n            id: 19840\r\n          }, {\r\n            data: \"whammy\",\r\n            id: 22337\r\n          }, {\r\n            data: s(c.duration),\r\n            id: 17545\r\n          }]\r\n        }, {\r\n          id: 374648427,\r\n          data: [{\r\n            id: 174,\r\n            data: [{\r\n              data: 1,\r\n              id: 215\r\n            }, {\r\n              data: 1,\r\n              id: 25541\r\n            }, {\r\n              data: 0,\r\n              id: 156\r\n            }, {\r\n              data: \"und\",\r\n              id: 2274716\r\n            }, {\r\n              data: \"V_VP8\",\r\n              id: 134\r\n            }, {\r\n              data: \"VP8\",\r\n              id: 2459272\r\n            }, {\r\n              data: 1,\r\n              id: 131\r\n            }, {\r\n              id: 224,\r\n              data: [{\r\n                data: c.width,\r\n                id: 176\r\n              }, {\r\n                data: c.height,\r\n                id: 186\r\n              }]\r\n            }]\r\n          }]\r\n        }]\r\n      }], e = 0, d = 0; e < a.length;) {\r\n      var g = [],\r\n        f = 0;\r\n      do g.push(a[e]), f += a[e].duration, e++; while (e < a.length && 3E4 > f);\r\n      var h = 0,\r\n        g = {\r\n          id: 524531317,\r\n          data: [{\r\n            data: d,\r\n            id: 231\r\n          }].concat(g.map(function(a) {\r\n            var b = t({\r\n              discardable: 0,\r\n              frame: a.data.slice(4),\r\n              invisible: 0,\r\n              keyframe: 1,\r\n              lacing: 0,\r\n              trackNum: 1,\r\n              timecode: Math.round(h)\r\n            });\r\n            h += a.duration;\r\n            return {\r\n              data: b,\r\n              id: 163\r\n            }\r\n          }))\r\n        };\r\n      c[1].data.push(g);\r\n      d += f\r\n    }\r\n    return m(c, b)\r\n  }\r\n\r\n  function r(a) {\r\n    for (var b = a[0].width, c = a[0].height, e = a[0].duration,\r\n        d = 1; d < a.length; d++) {\r\n      if (a[d].width != b) throw \"Frame \" + (d + 1) + \" has a different width\";\r\n      if (a[d].height != c) throw \"Frame \" + (d + 1) + \" has a different height\";\r\n      if (0 > a[d].duration || 32767 < a[d].duration) throw \"Frame \" + (d + 1) + \" has a weird duration (must be between 0 and 32767)\";\r\n      e += a[d].duration\r\n    }\r\n    return {\r\n      duration: e,\r\n      width: b,\r\n      height: c\r\n    }\r\n  }\r\n\r\n  function u(a) {\r\n    for (var b = []; 0 < a;) b.push(a & 255), a >>= 8;\r\n    return new Uint8Array(b.reverse())\r\n  }\r\n\r\n  function n(a) {\r\n    var b = [];\r\n    a = (a.length % 8 ? Array(9 - a.length % 8).join(\"0\") : \"\") + a;\r\n    for (var c = 0; c < a.length; c += 8) b.push(parseInt(a.substr(c,\r\n      8), 2));\r\n    return new Uint8Array(b)\r\n  }\r\n\r\n  function m(a, b) {\r\n    for (var c = [], e = 0; e < a.length; e++) {\r\n      var d = a[e].data;\r\n      \"object\" == typeof d && (d = m(d, b));\r\n      \"number\" == typeof d && (d = n(d.toString(2)));\r\n      if (\"string\" == typeof d) {\r\n        for (var g = new Uint8Array(d.length), f = 0; f < d.length; f++) g[f] = d.charCodeAt(f);\r\n        d = g\r\n      }\r\n      f = d.size || d.byteLength || d.length;\r\n      g = Math.ceil(Math.ceil(Math.log(f) / Math.log(2)) / 8);\r\n      f = f.toString(2);\r\n      f = Array(7 * g + 8 - f.length).join(\"0\") + f;\r\n      g = Array(g).join(\"0\") + \"1\" + f;\r\n      c.push(u(a[e].id));\r\n      c.push(n(g));\r\n      c.push(d)\r\n    }\r\n    return b ? (c = p(c), new Uint8Array(c)) :\r\n      new Blob(c, {\r\n        type: \"video/webm\"\r\n      })\r\n  }\r\n\r\n  function p(a, b) {\r\n    null == b && (b = []);\r\n    for (var c = 0; c < a.length; c++) \"object\" == typeof a[c] ? p(a[c], b) : b.push(a[c]);\r\n    return b\r\n  }\r\n\r\n  function t(a) {\r\n    var b = 0;\r\n    a.keyframe && (b |= 128);\r\n    a.invisible && (b |= 8);\r\n    a.lacing && (b |= a.lacing << 1);\r\n    a.discardable && (b |= 1);\r\n    if (127 < a.trackNum) throw \"TrackNumber > 127 not supported\";\r\n    return [a.trackNum | 128, a.timecode >> 8, a.timecode & 255, b].map(function(a) {\r\n      return String.fromCharCode(a)\r\n    }).join(\"\") + a.frame\r\n  }\r\n\r\n  function q(a) {\r\n    for (var b = a.RIFF[0].WEBP[0], c = b.indexOf(\"\\u009d\\u0001*\"),\r\n        e = 0, d = []; 4 > e; e++) d[e] = b.charCodeAt(c + 3 + e);\r\n    e = d[1] << 8 | d[0];\r\n    c = e & 16383;\r\n    e = d[3] << 8 | d[2];\r\n    return {\r\n      width: c,\r\n      height: e & 16383,\r\n      data: b,\r\n      riff: a\r\n    }\r\n  }\r\n\r\n  function k(a) {\r\n    for (var b = 0, c = {}; b < a.length;) {\r\n      var e = a.substr(b, 4),\r\n        d = parseInt(a.substr(b + 4, 4).split(\"\").map(function(a) {\r\n          a = a.charCodeAt(0).toString(2);\r\n          return Array(8 - a.length + 1).join(\"0\") + a\r\n        }).join(\"\"), 2),\r\n        g = a.substr(b + 4 + 4, d),\r\n        b = b + (8 + d);\r\n      c[e] = c[e] || [];\r\n      \"RIFF\" == e || \"LIST\" == e ? c[e].push(k(g)) : c[e].push(g)\r\n    }\r\n    return c\r\n  }\r\n\r\n  function s(a) {\r\n    return [].slice.call(new Uint8Array((new Float64Array([a])).buffer),\r\n      0).map(function(a) {\r\n      return String.fromCharCode(a)\r\n    }).reverse().join(\"\")\r\n  }\r\n\r\n  function l(a, b) {\r\n    this.frames = [];\r\n    this.duration = 1E3 / a;\r\n    this.quality = b || .8\r\n  }\r\n  l.prototype.add = function(a, b) {\r\n    if (\"undefined\" != typeof b && this.duration) throw \"you can't pass a duration if the fps is set\";\r\n    if (\"undefined\" == typeof b && !this.duration) throw \"if you don't have the fps set, you ned to have durations here.\";\r\n    \"canvas\" in a && (a = a.canvas);\r\n    if (\"toDataURL\" in a) a = a.toDataURL(\"image/webp\", this.quality);\r\n    else if (\"string\" != typeof a) throw \"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string\";\r\n    if (!/^data:image\\/webp;base64,/ig.test(a)) throw \"Input must be formatted properly as a base64 encoded DataURI of type image/webp\";\r\n    this.frames.push({\r\n      image: a,\r\n      duration: b || this.duration\r\n    })\r\n  };\r\n  l.prototype.compile = function(a) {\r\n    return new h(this.frames.map(function(a) {\r\n      var c = q(k(atob(a.image.slice(23))));\r\n      c.duration = a.duration;\r\n      return c\r\n    }), a)\r\n  };\r\n  return {\r\n    Video: l,\r\n    fromImageArray: function(a, b, c) {\r\n      return h(a.map(function(a) {\r\n        a = q(k(atob(a.slice(23))));\r\n        a.duration = 1E3 / b;\r\n        return a\r\n      }), c)\r\n    },\r\n    toWebM: h\r\n  }\r\n}();\r\n\r\nplayground.VideoRecorder = function(app, args) {\r\n\r\n  this.app = app;\r\n\r\n};\r\n\r\nplayground.VideoRecorder.prototype = {\r\n\r\n  setup: function(args) {\r\n\r\n    this.region = false;\r\n\r\n    playground.extend(this, {\r\n      followMouse: false,\r\n      framerate: 20,\r\n      scale: 1.0\r\n    }, args);\r\n\r\n    if (!this.region) {\r\n      this.region = [0, 0, this.app.layer.width, this.app.layer.height];\r\n    }\r\n\r\n    this.playbackRate = this.framerate / 60;\r\n\r\n    this.layer = cq(this.region[2] * this.scale | 0, this.region[3] * this.scale | 0);\r\n  },\r\n\r\n  start: function(args) {\r\n    this.setup(args);\r\n    this.encoder = new Whammy.Video(this.framerate);\r\n    this.captureTimeout = 0;\r\n    this.recording = true;\r\n  },\r\n\r\n  step: function(delta) {\r\n\r\n    if (this.encoder) {\r\n\r\n      this.captureTimeout -= delta * 1000;\r\n\r\n      if (this.captureTimeout <= 0) {\r\n        this.captureTimeout = 1000 / this.framerate + this.captureTimeout;\r\n\r\n        this.layer.drawImage(this.app.layer.canvas, this.region[0], this.region[1], this.region[2], this.region[3], 0, 0, this.layer.width, this.layer.height);\r\n        this.encoder.add(this.layer.canvas);\r\n      }\r\n\r\n      this.app.screen.save().lineWidth(8).strokeStyle(\"#c00\").strokeRect(0, 0, this.app.screen.width, this.app.screen.height).restore();\r\n    }\r\n\r\n  },\r\n\r\n  stop: function() {\r\n    if (!this.encoder) return;\r\n    var output = this.encoder.compile();\r\n    var url = (window.webkitURL || window.URL).createObjectURL(output);\r\n    window.open(url);\r\n    this.recording = false;\r\n\r\n    delete this.encoder;\r\n  },\r\n\r\n  toggle: function(args) {\r\n    if (this.encoder) this.stop();\r\n    else this.start(args);\r\n  }\r\n\r\n};\r\n\r\nPlayground.SoundInterface = {\r\n\r\n};\r\n\r\nPlayground.Sound = function(parent, audioContext) {\r\n\r\n  this.parent = parent;\r\n\r\n  var canPlayMp3 = (new Audio).canPlayType(\"audio/mp3\");\r\n  var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\r\n  if (canPlayMp3) this.audioFormat = \"mp3\";\r\n  else this.audioFormat = \"ogg\";\r\n\r\n  this.context = audioContext;\r\n\r\n  this.gainNode = this.context.createGain()\r\n  this.gainNode.connect(this.context.destination);\r\n\r\n  this.compressor = this.context.createDynamicsCompressor();\r\n  this.compressor.connect(this.gainNode);\r\n\r\n  this.output = this.gainNode;\r\n\r\n  this.gainNode.gain.value = 1.0;\r\n\r\n  this.pool = [];\r\n  this.volume = 1.0;\r\n\r\n  this.setMasterPosition(0, 0, 0);\r\n\r\n  this.loops = [];\r\n\r\n};\r\n\r\nPlayground.Sound.prototype = {\r\n\r\n  buffers: {},\r\n  aliases: {},\r\n\r\n  alias: function(alias, source, volume, rate) {\r\n\r\n    this.aliases[alias] = {\r\n      source: source,\r\n      volume: volume,\r\n      rate: rate\r\n    };\r\n\r\n  },\r\n\r\n  setMaster: function(volume) {\r\n\r\n    this.volume = volume;\r\n\r\n    this.gainNode.gain.value = volume;\r\n\r\n  },\r\n\r\n  load: function(file) {\r\n\r\n    var url = \"sounds/\" + file + \".\" + this.audioFormat;\r\n    var sampler = this;\r\n\r\n    var request = new XMLHttpRequest();\r\n\r\n    request.open(\"GET\", url, true);\r\n    request.responseType = \"arraybuffer\";\r\n\r\n    var id = this.parent.loader.add();\r\n\r\n    request.onload = function() {\r\n\r\n      sampler.context.decodeAudioData(this.response, function(decodedBuffer) {\r\n        sampler.buffers[file] = decodedBuffer;\r\n        sampler.parent.loader.ready(id);\r\n      });\r\n\r\n    }\r\n\r\n    request.send();\r\n\r\n  },\r\n\r\n  cleanArray: function(array, property) {\r\n    for (var i = 0, len = array.length; i < len; i++) {\r\n      if (array[i] === null || (property && array[i][property])) {\r\n        array.splice(i--, 1);\r\n        len--;\r\n      }\r\n    }\r\n  },\r\n\r\n  setMasterPosition: function(x, y, z) {\r\n\r\n    this.masterPosition = {\r\n      x: x,\r\n      y: y,\r\n      z: z\r\n    };\r\n\r\n    this.context.listener.setPosition(x, y, z)\r\n      // this.context.listener.setOrientation(0, 0, -1, 0, 1, 0);\r\n      // this.context.listener.dopplerFactor = 1;\r\n      // this.context.listener.speedOfSound = 343.3;\r\n  },\r\n\r\n  getSoundBuffer: function() {\r\n    if (!this.pool.length) {\r\n      for (var i = 0; i < 100; i++) {\r\n\r\n        var buffer, gain, panner;\r\n\r\n        var nodes = [\r\n          buffer = this.context.createBufferSource(),\r\n          gain = this.context.createGain(),\r\n          panner = this.context.createPanner()\r\n        ];\r\n\r\n        panner.distanceModel = \"linear\";\r\n\r\n        // 1 - rolloffFactor * (distance - refDistance) / (maxDistance - refDistance)\r\n        // refDistance / (refDistance + rolloffFactor * (distance - refDistance))\r\n        panner.refDistance = 1;\r\n        panner.maxDistance = 600;\r\n        panner.rolloffFactor = 1.0;\r\n\r\n\r\n        // panner.setOrientation(-1, -1, 0);\r\n\r\n        this.pool.push(nodes);\r\n\r\n        nodes[0].connect(nodes[1]);\r\n        // nodes[1].connect(nodes[2]);\r\n        nodes[1].connect(this.output);\r\n      }\r\n    }\r\n\r\n    return this.pool.pop();\r\n  },\r\n\r\n  play: function(name, loop) {\r\n\r\n    var alias = this.aliases[name];\r\n\r\n    var nodes = this.getSoundBuffer();\r\n\r\n    if(alias) name = alias.source;\r\n\r\n    bufferSource = nodes[0];\r\n    bufferSource.gainNode = nodes[1];\r\n    bufferSource.pannerNode = nodes[2];\r\n    bufferSource.buffer = this.buffers[name];\r\n    bufferSource.loop = loop || false;\r\n    bufferSource.key = name;\r\n\r\n    bufferSource.alias = alias;\r\n\r\n    this.setVolume(bufferSource, 1.0);\r\n    this.setPlaybackRate(bufferSource, 1.0);\r\n\r\n    if (this.loop) {\r\n      //  bufferSource.loopStart = this.loopStart;\r\n      // bufferSource.loopEnd = this.loopEnd;\r\n    }\r\n\r\n\r\n    bufferSource.start(0);\r\n\r\n    bufferSource.volumeLimit = 1;\r\n\r\n    this.setPosition(bufferSource, this.masterPosition.x, this.masterPosition.y, this.masterPosition.z);\r\n\r\n    return bufferSource;\r\n  },\r\n\r\n  stop: function(what) {\r\n\r\n    if (!what) return;\r\n\r\n    what.stop(0);\r\n\r\n  },\r\n\r\n  setPlaybackRate: function(sound, rate) {\r\n\r\n    if (!sound) return;\r\n\r\n    if (sound.alias) rate *= sound.alias.rate;\r\n\r\n    return sound.playbackRate.value = rate;\r\n  },\r\n\r\n  setPosition: function(sound, x, y, z) {\r\n\r\n    if (!sound) return;\r\n\r\n    sound.pannerNode.setPosition(x, y || 0, z || 0);\r\n  },\r\n\r\n  setVelocity: function(sound, x, y, z) {\r\n\r\n    if (!sound) return;\r\n\r\n    sound.pannerNode.setPosition(x, y || 0, z || 0);\r\n\r\n  },\r\n\r\n  getVolume: function(sound) {\r\n\r\n    if (!sound) return;\r\n\r\n    return sound.gainNode.gain.value;\r\n\r\n  },\r\n\r\n  setVolume: function(sound, volume) {\r\n\r\n    if (!sound) return;\r\n\r\n    if (sound.alias) volume *= sound.alias.volume;\r\n\r\n    return sound.gainNode.gain.value = Math.max(0, volume);\r\n  },\r\n\r\n  fadeOut: function(sound) {\r\n\r\n    if (!sound) return;\r\n\r\n    sound.fadeOut = true;\r\n\r\n    this.loops.push(sound);\r\n\r\n    return sound;\r\n\r\n  },\r\n\r\n  fadeIn: function(sound) {\r\n\r\n    if (!sound) return;\r\n\r\n    sound.fadeIn = true;\r\n\r\n    this.loops.push(sound);\r\n\r\n    return sound;\r\n\r\n  },\r\n\r\n  step: function(delta) {\r\n\r\n    for (var i = 0; i < this.loops.length; i++) {\r\n\r\n      var loop = this.loops[i];\r\n\r\n      if (loop.fadeIn) {\r\n        var volume = this.getVolume(loop);\r\n        volume = this.setVolume(loop, Math.min(1.0, volume + delta * 0.5));\r\n\r\n        if (volume >= 1.0) {\r\n          this.loops.splice(i--, 1);\r\n          this.stop(loop);\r\n        }\r\n      }\r\n\r\n      if (loop.fadeOut) {\r\n        var volume = this.getVolume(loop);\r\n        volume = this.setVolume(loop, Math.min(1.0, volume - delta * 0.5));\r\n\r\n        if (volume <= 0) {\r\n          this.loops.splice(i--, 1);\r\n          this.stop(loop);\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nplayground.extend(Playground.Sound.prototype, Playground.SoundInterface);\r\n\r\nPlayground.SoundFallback = function(parent) {\r\n\r\n  this.parent = parent;\r\n\r\n  var canPlayMp3 = (new Audio).canPlayType(\"audio/mp3\");\r\n  var canPlayOgg = (new Audio).canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\r\n  if (canPlayMp3) this.audioFormat = \"mp3\";\r\n  else this.audioFormat = \"ogg\";\r\n\r\n};\r\n\r\nPlayground.SoundFallback.prototype = {\r\n\r\n  samples: {},\r\n\r\n  setMaster: function(volume) {\r\n\r\n    this.volume = volume;\r\n\r\n  },\r\n\r\n  setMasterPosition: function() {\r\n\r\n  },\r\n\r\n  setPosition: function(x, y, z) {\r\n    return;\r\n  },\r\n\r\n  load: function(file) {\r\n\r\n    var url = \"sounds/\" + file + \".\" + this.audioFormat;\r\n\r\n    var loader = this.parent.loader;\r\n\r\n    this.parent.loader.add(url);\r\n\r\n    var audio = this.samples[file] = new Audio;\r\n\r\n    audio.addEventListener(\"canplay\", function() {\r\n      loader.ready(url);\r\n    });\r\n\r\n    audio.addEventListener(\"error\", function() {\r\n      loader.error(url);\r\n    });\r\n\r\n    audio.src = url;\r\n\r\n\r\n  },\r\n\r\n  play: function(key, loop) {\r\n\r\n    var sound = this.samples[key];\r\n\r\n    sound.currentTime = 0;\r\n    sound.loop = loop;\r\n    sound.play();\r\n\r\n    return sound;\r\n\r\n  },\r\n\r\n  stop: function(what) {\r\n\r\n    if (!what) return;\r\n\r\n    what.pause();\r\n\r\n  },\r\n\r\n  step: function(delta) {\r\n\r\n  },\r\n\r\n  setPlaybackRate: function(sound, rate) {\r\n\r\n    return;\r\n  },\r\n\r\n  setVolume: function(sound, volume) {\r\n\r\n    sound.volume = volume * this.volume;\r\n\r\n  },\r\n\r\n  setPosition: function() {\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\nplayground.extend(Playground.SoundFallback.prototype, Playground.SoundInterface);\r\n\r\n/* easing */\r\n\r\n/*\r\n\r\n  Ease 1.0\r\n\r\n  http://canvasquery.com\r\n\r\n  (c) 2015 by Rezoner - http://rezoner.net\r\n\r\n  `ease` may be freely distributed under the MIT license.\r\n\r\n*/\r\n\r\n(function() {\r\n\r\n  var ease = function(progress, easing) {\r\n\r\n    if (typeof ease.cache[easing] === \"function\") {\r\n\r\n      return ease.cache[easing](progress);\r\n\r\n    } else {\r\n\r\n      return ease.spline(progress, easing || ease.defaultEasing);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  var extend = function() {\r\n    for (var i = 1; i < arguments.length; i++) {\r\n      for (var j in arguments[i]) {\r\n        arguments[0][j] = arguments[i][j];\r\n      }\r\n    }\r\n\r\n    return arguments[0];\r\n  };\r\n\r\n  extend(ease, {          \r\n\r\n    defaultEasing: \"016\",\r\n\r\n    cache: {\r\n\r\n      linear: function(t) {\r\n        return t\r\n      },\r\n\r\n      inQuad: function(t) {\r\n        return t * t\r\n      },\r\n      outQuad: function(t) {\r\n        return t * (2 - t)\r\n      },\r\n      inOutQuad: function(t) {\r\n        return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n      },\r\n      inCubic: function(t) {\r\n        return t * t * t\r\n      },\r\n      outCubic: function(t) {\r\n        return (--t) * t * t + 1\r\n      },\r\n      inOutCubic: function(t) {\r\n        return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n      },\r\n      inQuart: function(t) {\r\n        return t * t * t * t\r\n      },\r\n      outQuart: function(t) {\r\n        return 1 - (--t) * t * t * t\r\n      },\r\n      inOutQuart: function(t) {\r\n        return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n      },\r\n      inQuint: function(t) {\r\n        return t * t * t * t * t\r\n      },\r\n      outQuint: function(t) {\r\n        return 1 + (--t) * t * t * t * t\r\n      },\r\n      inOutQuint: function(t) {\r\n        return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n      },\r\n      inSine: function(t) {\r\n        return -1 * Math.cos(t / 1 * (Math.PI * 0.5)) + 1;\r\n      },\r\n      outSine: function(t) {\r\n        return Math.sin(t / 1 * (Math.PI * 0.5));\r\n      },\r\n      inOutSine: function(t) {\r\n        return -1 / 2 * (Math.cos(Math.PI * t) - 1);\r\n      },\r\n      inExpo: function(t) {\r\n        return (t == 0) ? 0 : Math.pow(2, 10 * (t - 1));\r\n      },\r\n      outExpo: function(t) {\r\n        return (t == 1) ? 1 : (-Math.pow(2, -10 * t) + 1);\r\n      },\r\n      inOutExpo: function(t) {\r\n        if (t == 0) return 0;\r\n        if (t == 1) return 1;\r\n        if ((t /= 1 / 2) < 1) return 1 / 2 * Math.pow(2, 10 * (t - 1));\r\n        return 1 / 2 * (-Math.pow(2, -10 * --t) + 2);\r\n      },\r\n      inCirc: function(t) {\r\n        return -1 * (Math.sqrt(1 - t * t) - 1);\r\n      },\r\n      outCirc: function(t) {\r\n        return Math.sqrt(1 - (t = t - 1) * t);\r\n      },\r\n      inOutCirc: function(t) {\r\n        if ((t /= 1 / 2) < 1) return -1 / 2 * (Math.sqrt(1 - t * t) - 1);\r\n        return 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1);\r\n      },\r\n      inElastic: function(t) {\r\n        var s = 1.70158;\r\n        var p = 0;\r\n        var a = 1;\r\n        if (t == 0) return 0;\r\n        if (t == 1) return 1;\r\n        if (!p) p = 0.3;\r\n        if (a < 1) {\r\n          a = 1;\r\n          var s = p / 4;\r\n        } else var s = p / (2 * Math.PI) * Math.asin(1 / a);\r\n        return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p));\r\n      },\r\n      outElastic: function(t) {\r\n        var s = 1.70158;\r\n        var p = 0;\r\n        var a = 1;\r\n        if (t == 0) return 0;\r\n        if (t == 1) return 1;\r\n        if (!p) p = 0.3;\r\n        if (a < 1) {\r\n          a = 1;\r\n          var s = p / 4;\r\n        } else var s = p / (2 * Math.PI) * Math.asin(1 / a);\r\n        return a * Math.pow(2, -10 * t) * Math.sin((t - s) * (2 * Math.PI) / p) + 1;\r\n      },\r\n      inOutElastic: function(t) {\r\n        var s = 1.70158;\r\n        var p = 0;\r\n        var a = 1;\r\n        if (t == 0) return 0;\r\n        if ((t /= 1 / 2) == 2) return 1;\r\n        if (!p) p = (0.3 * 1.5);\r\n        if (a < 1) {\r\n          a = 1;\r\n          var s = p / 4;\r\n        } else var s = p / (2 * Math.PI) * Math.asin(1 / a);\r\n        if (t < 1) return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p));\r\n        return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p) * 0.5 + 1;\r\n      },\r\n      inBack: function(t, s) {\r\n        if (s == undefined) s = 1.70158;\r\n        return 1 * t * t * ((s + 1) * t - s);\r\n      },\r\n      outBack: function(t, s) {\r\n        if (s == undefined) s = 1.70158;\r\n        return 1 * ((t = t / 1 - 1) * t * ((s + 1) * t + s) + 1);\r\n      },\r\n      inOutBack: function(t, s) {\r\n        if (s == undefined) s = 1.70158;\r\n        if ((t /= 1 / 2) < 1) return 1 / 2 * (t * t * (((s *= (1.525)) + 1) * t - s));\r\n        return 1 / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2);\r\n      },\r\n      inBounce: function(t) {\r\n        return 1 - this.outBounce(1 - t);\r\n      },\r\n      outBounce: function(t) {\r\n        if ((t /= 1) < (1 / 2.75)) {\r\n          return (7.5625 * t * t);\r\n        } else if (t < (2 / 2.75)) {\r\n          return (7.5625 * (t -= (1.5 / 2.75)) * t + .75);\r\n        } else if (t < (2.5 / 2.75)) {\r\n          return (7.5625 * (t -= (2.25 / 2.75)) * t + .9375);\r\n        } else {\r\n          return (7.5625 * (t -= (2.625 / 2.75)) * t + .984375);\r\n        }\r\n      },\r\n      inOutBounce: function(t) {\r\n        if (t < 1 / 2) return this.inBounce(t * 2) * 0.5;\r\n        return this.outBounce(t * 2 - 1) * 0.5 + 0.5;\r\n      }\r\n    },\r\n\r\n    translateEasing: function(key) {\r\n\r\n      if (!this.cache[key]) {\r\n        var array = key.split('');\r\n\r\n        var sign = 1;\r\n        var signed = false;\r\n\r\n        for (var i = 0; i < array.length; i++) {\r\n\r\n          var char = array[i];\r\n\r\n          if (char === \"-\") {\r\n            sign = -1;\r\n            signed = true;\r\n            array.splice(i--, 1);\r\n          } else if (char === \"+\") {\r\n            sign = 1;\r\n            array.splice(i--, 1);\r\n          } else array[i] = parseInt(array[i], 16) * sign;\r\n\r\n        }\r\n\r\n        var min = Math.min.apply(null, array);\r\n        var max = Math.max.apply(null, array);\r\n        var diff = max - min;\r\n        var cache = [];\r\n        var normalized = [];\r\n\r\n        for (var i = 0; i < array.length; i++) {\r\n          if (signed) {\r\n            var diff = Math.max(Math.abs(min), Math.abs(max))\r\n            normalized.push((array[i]) / diff);\r\n          } else {\r\n            var diff = max - min;\r\n            normalized.push((array[i] - min) / diff);\r\n          }\r\n        }\r\n\r\n        this.cache[key] = normalized;\r\n\r\n      }\r\n\r\n      return this.cache[key]\r\n\r\n    },\r\n\r\n    /*\r\n\r\n      Cubic-spline interpolation by Ivan Kuckir\r\n\r\n      http://blog.ivank.net/interpolation-with-cubic-splines.html\r\n\r\n      With slight modifications by Morgan Herlocker\r\n\r\n      https://github.com/morganherlocker/cubic-spline\r\n\r\n    */\r\n\r\n    splineK: {},\r\n    splineX: {},\r\n    splineY: {},\r\n\r\n    insertIntermediateValues: function(a) {\r\n      var result = [];\r\n      for (var i = 0; i < a.length; i++) {\r\n        result.push(a[i]);\r\n\r\n        if (i < a.length - 1) result.push(a[i + 1] + (a[i] - a[i + 1]) * 0.6);\r\n      }\r\n\r\n      return result;\r\n    },\r\n\r\n    spline: function(x, key) {\r\n\r\n      if (!this.splineK[key]) {\r\n\r\n        var xs = [];\r\n        var ys = this.translateEasing(key);\r\n\r\n        // ys = this.insertIntermediateValues(ys);\r\n\r\n        if (!ys.length) return 0;\r\n\r\n        for (var i = 0; i < ys.length; i++) xs.push(i * (1 / (ys.length - 1)));\r\n\r\n        var ks = xs.map(function() {\r\n          return 0\r\n        });\r\n\r\n        ks = this.getNaturalKs(xs, ys, ks);\r\n\r\n        this.splineX[key] = xs;\r\n        this.splineY[key] = ys;\r\n        this.splineK[key] = ks;\r\n\r\n      }\r\n\r\n      if (x > 1) return this.splineY[key][this.splineY[key].length - 1];\r\n\r\n      var ks = this.splineK[key];\r\n      var xs = this.splineX[key];\r\n      var ys = this.splineY[key];\r\n\r\n      var i = 1;\r\n\r\n      while (xs[i] < x) i++;\r\n\r\n      var t = (x - xs[i - 1]) / (xs[i] - xs[i - 1]);\r\n      var a = ks[i - 1] * (xs[i] - xs[i - 1]) - (ys[i] - ys[i - 1]);\r\n      var b = -ks[i] * (xs[i] - xs[i - 1]) + (ys[i] - ys[i - 1]);\r\n      var q = (1 - t) * ys[i - 1] + t * ys[i] + t * (1 - t) * (a * (1 - t) + b * t);\r\n\r\n      /*\r\n      var py = ys[i - 2];\r\n      var cy = ys[i - 1];\r\n      var ny = (i < ys.length - 1) ? ys[i] : ys[i - 1];\r\n\r\n      if (q > ny) {\r\n        var diff = (q - py);\r\n        //q = py + diff;\r\n\r\n      }\r\n\r\n    if (cy === ny && cy === py) q = py;\r\n    */\r\n\r\n\r\n      return q;\r\n    },\r\n\r\n    getNaturalKs: function(xs, ys, ks) {\r\n      var n = xs.length - 1;\r\n      var A = this.zerosMat(n + 1, n + 2);\r\n\r\n      for (var i = 1; i < n; i++) // rows\r\n      {\r\n        A[i][i - 1] = 1 / (xs[i] - xs[i - 1]);\r\n        A[i][i] = 2 * (1 / (xs[i] - xs[i - 1]) + 1 / (xs[i + 1] - xs[i]));\r\n        A[i][i + 1] = 1 / (xs[i + 1] - xs[i]);\r\n        A[i][n + 1] = 3 * ((ys[i] - ys[i - 1]) / ((xs[i] - xs[i - 1]) * (xs[i] - xs[i - 1])) + (ys[i + 1] - ys[i]) / ((xs[i + 1] - xs[i]) * (xs[i + 1] - xs[i])));\r\n      }\r\n\r\n      A[0][0] = 2 / (xs[1] - xs[0]);\r\n      A[0][1] = 1 / (xs[1] - xs[0]);\r\n      A[0][n + 1] = 3 * (ys[1] - ys[0]) / ((xs[1] - xs[0]) * (xs[1] - xs[0]));\r\n\r\n      A[n][n - 1] = 1 / (xs[n] - xs[n - 1]);\r\n      A[n][n] = 2 / (xs[n] - xs[n - 1]);\r\n      A[n][n + 1] = 3 * (ys[n] - ys[n - 1]) / ((xs[n] - xs[n - 1]) * (xs[n] - xs[n - 1]));\r\n\r\n      return this.solve(A, ks);\r\n    },\r\n\r\n    solve: function(A, ks) {\r\n      var m = A.length;\r\n      for (var k = 0; k < m; k++) // column\r\n      {\r\n        // pivot for column\r\n        var i_max = 0;\r\n        var vali = Number.NEGATIVE_INFINITY;\r\n        for (var i = k; i < m; i++)\r\n          if (A[i][k] > vali) {\r\n            i_max = i;\r\n            vali = A[i][k];\r\n          }\r\n        this.splineSwapRows(A, k, i_max);\r\n\r\n        // for all rows below pivot\r\n        for (var i = k + 1; i < m; i++) {\r\n          for (var j = k + 1; j < m + 1; j++)\r\n            A[i][j] = A[i][j] - A[k][j] * (A[i][k] / A[k][k]);\r\n          A[i][k] = 0;\r\n        }\r\n      }\r\n      for (var i = m - 1; i >= 0; i--) // rows = columns\r\n      {\r\n        var v = A[i][m] / A[i][i];\r\n        ks[i] = v;\r\n        for (var j = i - 1; j >= 0; j--) // rows\r\n        {\r\n          A[j][m] -= A[j][i] * v;\r\n          A[j][i] = 0;\r\n        }\r\n      }\r\n      return ks;\r\n    },\r\n\r\n    zerosMat: function(r, c) {\r\n      var A = [];\r\n      for (var i = 0; i < r; i++) {\r\n        A.push([]);\r\n        for (var j = 0; j < c; j++) A[i].push(0);\r\n      }\r\n      return A;\r\n    },\r\n\r\n    splineSwapRows: function(m, k, l) {\r\n      var p = m[k];\r\n      m[k] = m[l];\r\n      m[l] = p;\r\n    }\r\n  });\r\n\r\n  playground.ease = ease;\r\n\r\n})();\r\n\r\n/* TweenManager */\r\n\r\nplayground.Tween = function(parent, context) {\r\n\r\n  this.parent = parent;\r\n  this.context = context;\r\n\r\n  playground.extend(this, {\r\n\r\n    actions: [],\r\n    index: -1,\r\n\r\n    prevEasing: \"045\",\r\n    prevDuration: 0.5\r\n\r\n  });\r\n\r\n  this.current = false;\r\n\r\n};\r\n\r\nplayground.Tween.prototype = {\r\n\r\n  add: function(properties, duration, easing) {\r\n\r\n    if (duration) this.prevDuration = duration;\r\n    else duration = 0.5;\r\n    if (easing) this.prevEasing = easing;\r\n    else easing = \"045\";\r\n\r\n    this.actions.push([properties, duration, easing]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  to: function(properties, duration, easing) {\r\n    return this.add(properties, duration, easing);\r\n  },\r\n\r\n  loop: function() {\r\n\r\n    this.looped = true;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  repeat: function(times) {\r\n\r\n    this.actions.push([\"repeat\", times]);\r\n\r\n  },\r\n\r\n  wait: function(time) {\r\n\r\n    this.actions.push([\"wait\", time]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  delay: function(time) {\r\n\r\n    this.actions.push([\"wait\", time]);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.parent.remove(this);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  play: function() {\r\n\r\n    this.parent.add(this);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n\r\n  end: function() {\r\n\r\n    var lastAnimationIndex = 0;\r\n\r\n    for (var i = this.index + 1; i < this.actions.length; i++) {\r\n      if (typeof this.actions[i][0] === \"object\") lastAnimationIndex = i;\r\n    }\r\n\r\n    this.index = lastAnimationIndex - 1;\r\n    this.next();\r\n    this.delta = this.duration;\r\n    this.step(0);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  forward: function() {\r\n\r\n    this.delta = this.duration;\r\n    this.step(0);\r\n\r\n  },\r\n\r\n  rewind: function() {\r\n\r\n    this.delta = 0;\r\n    this.step(0);\r\n\r\n  },\r\n\r\n  next: function() {\r\n\r\n    this.delta = 0;\r\n\r\n    this.index++;\r\n\r\n    if (this.index >= this.actions.length) {\r\n\r\n      if (this.looped) {\r\n        this.index = 0;\r\n      } else {\r\n        this.parent.remove(this);\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.current = this.actions[this.index];\r\n\r\n    if (this.current[0] === \"wait\") {\r\n\r\n      this.duration = this.current[1];\r\n      this.currentAction = \"wait\";\r\n\r\n    } else {\r\n\r\n      /* calculate changes */\r\n\r\n      var properties = this.current[0];\r\n\r\n      /* keep keys as array for 0.0001% performance boost */\r\n\r\n      this.keys = Object.keys(properties);\r\n\r\n      this.change = [];\r\n      this.before = [];\r\n      this.types = [];\r\n\r\n      for (i = 0; i < this.keys.length; i++) {\r\n        var key = this.keys[i];\r\n\r\n        if (typeof this.context[key] === \"number\") {\r\n          this.before.push(this.context[key]);\r\n          this.change.push(properties[key] - this.context[key]);\r\n          this.types.push(0);\r\n        } else {\r\n          var before = cq.color(this.context[key]);\r\n\r\n          this.before.push(before);\r\n\r\n          var after = cq.color(properties[key]);\r\n\r\n          var temp = [];\r\n\r\n          for (var j = 0; j < 3; j++) {\r\n            temp.push(after[j] - before[j]);\r\n          }\r\n\r\n          this.change.push(temp);\r\n\r\n          this.types.push(1);\r\n        }\r\n\r\n      }\r\n\r\n      this.currentAction = \"animate\";\r\n\r\n      this.duration = this.current[1];\r\n      this.easing = this.current[2];\r\n\r\n    }\r\n\r\n\r\n  },\r\n\r\n  prev: function() {\r\n\r\n  },\r\n\r\n  step: function(delta) {\r\n    this.delta += delta;\r\n\r\n    if (!this.current) this.next();\r\n\r\n    switch (this.currentAction) {\r\n\r\n      case \"animate\":\r\n        this.doAnimate(delta);\r\n        break;\r\n\r\n      case \"wait\":\r\n        this.doWait(delta);\r\n        break;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  doAnimate: function(delta) {\r\n\r\n    this.progress = Math.min(1, this.delta / this.duration);\r\n\r\n    var mod = playground.ease(this.progress, this.easing);\r\n\r\n    for (var i = 0; i < this.keys.length; i++) {\r\n\r\n      var key = this.keys[i];\r\n\r\n      switch (this.types[i]) {\r\n\r\n        /* number */\r\n\r\n        case 0:\r\n\r\n          this.context[key] = this.before[i] + this.change[i] * mod;\r\n\r\n          break;\r\n\r\n          /* color */\r\n\r\n        case 1:\r\n\r\n          var change = this.change[i];\r\n          var before = this.before[i];\r\n          var color = [];\r\n\r\n          for (var j = 0; j < 3; j++) {\r\n            color.push(before[j] + change[j] * mod | 0);\r\n          }\r\n\r\n          this.context[key] = \"rgb(\" + color.join(\",\") + \")\";\r\n\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (this.progress >= 1) {\r\n      this.next();\r\n    }\r\n\r\n  },\r\n\r\n  doWait: function(delta) {\r\n\r\n    if (this.delta >= this.duration) this.next();\r\n\r\n  }\r\n\r\n};\r\n\r\nplayground.TweenManager = function(parent) {\r\n\r\n  this.tweens = [];\r\n\r\n  if (parent) {\r\n    this.parent = parent;\r\n    this.parent.tween = this.tween.bind(this);\r\n  }\r\n\r\n  this.delta = 0;\r\n\r\n};\r\n\r\nplayground.TweenManager.prototype = {\r\n\r\n  defaultEasing: \"128\",\r\n\r\n  tween: function(context) {\r\n\r\n    var tween = new playground.Tween(this, context);\r\n\r\n    this.add(tween);\r\n\r\n    return tween;\r\n\r\n  },\r\n\r\n  step: function(delta) {\r\n\r\n    this.delta += delta;\r\n\r\n    for (var i = 0; i < this.tweens.length; i++) {\r\n\r\n      var tween = this.tweens[i];\r\n\r\n      tween.step(delta);\r\n\r\n      if (tween._remove) this.tweens.splice(i--, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  add: function(tween) {\r\n\r\n    tween._remove = false;\r\n\r\n    var index = this.tweens.indexOf(tween);\r\n\r\n    if (index === -1) this.tweens.push(tween);\r\n\r\n  },\r\n\r\n  remove: function(tween) {\r\n\r\n    tween._remove = true;\r\n\r\n  }\r\n\r\n};\r\n\r\nmodule.exports = playground;\r\n"
  ]
}